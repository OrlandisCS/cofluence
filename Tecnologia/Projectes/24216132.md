Projectes : Query per recuperar l'estat de les cadenes de TSL  

1.  [Projectes](index.md)
2.  [PSIS](PSIS_24215797.md)
3.  [PSIS - WIKI](PSIS---WIKI_24215598.md)
4.  [Scripts SQL](Scripts-SQL_24215612.md)

Projectes : Query per recuperar l'estat de les cadenes de TSL
=============================================================

Created by Áurea Alcaide, last modified on 16 julio 2019

select 
  tsl.COUNTRY, decode(tslsc.PROCESSING\_STATUS, 3, 'OK', 2, 'ERR DOWN CHAIN', 1, 'ERR DOWN CHAIN', '-'), decode(tslsc.CERTIFICATE\_TYPE, 1, 'TSL AC', 2, 'AC', 3, 'TA', 4, 'TSL TA', '-'), count(\*) 
from 
  D\_RI\_ATL\_TSL\_SERVICE\_CERT tslsc,
  D\_RI\_ATL\_TSL\_SERVICE tsls,
  D\_RI\_ATL\_TSL\_PROVIDER tslp,
  D\_RI\_ATL\_TSL tsl
where
  tsl.id = tslp.TSL
  and tslp.id = tsls.TSL\_PROVIDER
  and tsls.ID = tslsc.TSL\_SERVICE
  and tslsc.CERTIFICATE\_TYPE in (1,4)
group by tsl.COUNTRY, decode(tslsc.PROCESSING\_STATUS, 3, 'OK', 2, 'ERR DOWN CHAIN', 1, 'ERR DOWN CHAIN', '-'), decode(tslsc.CERTIFICATE\_TYPE, 1, 'TSL AC', 2, 'AC', 3, 'TA', 4, 'TSL TA', '-')
order by tsl.COUNTRY;

  

Cadenes completes:

select s.id, s.name, count(\*) 
from d\_ri\_atl\_tsl\_service\_cert sc,
d\_ri\_atl\_tsl\_service s,
d\_ri\_atl\_tsl\_provider p,
d\_ri\_atl\_tsl tsl
where s.id = sc.tsl\_service
and s.tsl\_provider = p.id
and tsl.id = p.tsl
and sc.processing\_status = 3
group by s.id, s.name;

  

Cadenes NO descarregades completament:

select s.id, s.name, count(\*) 
from d\_ri\_atl\_tsl\_service\_cert sc,
d\_ri\_atl\_tsl\_service s,
d\_ri\_atl\_tsl\_provider p,
d\_ri\_atl\_tsl tsl
where s.id = sc.tsl\_service
and s.tsl\_provider = p.id
and tsl.id = p.tsl
and sc.processing\_status != 3
group by s.id, s.name;

  

Taules a partir de la versió 5.4.0:

  

select 
  tsl.COUNTRY, decode(tslc.PROCESSING\_STATUS, 3, 'OK', 2, 'ERR DOWN CHAIN', 1, 'ERR DOWN CHAIN', '-'), decode(tslc.CERTIFICATE\_TYPE, 1, 'TSL AC', 2, 'AC', 3, 'TA', 4, 'TSL TA', '-'), count(\*) 
from 
  D\_RI\_ATL\_TSL\_CERT tslc,
  D\_RI\_ATL\_TSL\_SERVICE\_CERT tslsc,
  D\_RI\_ATL\_TSL\_SERVICE tsls,
  D\_RI\_ATL\_TSL\_PROVIDER tslp,
  D\_RI\_ATL\_TSL tsl
where
  tsl.id = tslp.TSL
  and tslp.id = tsls.TSL\_PROVIDER
  and tsls.ID = tslsc.SERVICE\_ID
  and tslc.CERTIFICATE\_TYPE in (1,4)
  and tslsc.CERTIFICATE\_ID = tslc.ID
group by tsl.COUNTRY, decode(tslc.PROCESSING\_STATUS, 3, 'OK', 2, 'ERR DOWN CHAIN', 1, 'ERR DOWN CHAIN', '-'), decode(tslc.CERTIFICATE\_TYPE, 1, 'TSL AC', 2, 'AC', 3, 'TA', 4, 'TSL TA', '-')
order by tsl.COUNTRY;

  

Cadenes completes:

select s.id, s.name, count(\*) 
from d\_ri\_atl\_tsl\_cert c,
d\_ri\_atl\_tsl\_service\_cert sc,
d\_ri\_atl\_tsl\_service s,
d\_ri\_atl\_tsl\_provider p,
d\_ri\_atl\_tsl tsl
where s.id = sc.service\_id
and s.tsl\_provider = p.id
and tsl.id = p.tsl
and sc.certificate\_id = c.id
and c.processing\_status = 3
group by s.id, s.name;

Cadenes NO descarregades completament:

select s.id, s.name, count(\*) 
from d\_ri\_atl\_tsl\_cert c,
d\_ri\_atl\_tsl\_service\_cert sc,
d\_ri\_atl\_tsl\_service s,
d\_ri\_atl\_tsl\_provider p,
d\_ri\_atl\_tsl tsl
where s.id = sc.service\_id
and s.tsl\_provider = p.id
and tsl.id = p.tsl
and sc.certificate\_id = c.id
and c.processing\_status != 3
group by s.id, s.name;

  

Document generated by Confluence on 07 junio 2025 00:00

[Atlassian](http://www.atlassian.com/)