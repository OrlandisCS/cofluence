Suport Tècnic : Altes SIA - Càrrega d'autoritzacions pel ministeri (Autoritzacions MINHAP)  

1.  [Suport Tècnic](index.html)
2.  [Suport Tècnic](13893782.html)
3.  [01 - Gestió Operativa](26313391.html)
4.  [Tasques complementàries](26313409.html)

Suport Tècnic : Altes SIA - Càrrega d'autoritzacions pel ministeri (Autoritzacions MINHAP)
==========================================================================================

Created by Unknown User (rjuradog), last modified by OTEC ST Maria Jose Salar on 09 April 2025

Aquesta tasca es realitza tant per a l'entorn de PRE com pel de PRO. 

º Per tots dos entorns caldrà descarregar el .jar. El cual es pot trobar a ruta (Sharepoint) Tecnologia - SUPORT\_TECNIC\\PROCEDIMENTS\\ALTASIA - Minhap

Procediment Alta SIA

Procediment altes SIA per a l'entorn de PRO I PRE
=================================================

Aquesta tasca sempre ens arribarà per un tiquet de JIRA. Exemple: [DES-1379](https://contacte.aoc.cat/browse/DES-1379) /  [ST-17011](https://contacte.aoc.cat/browse/ST-17011?src=confmacro) - Data cannot be retrieved due to an unexpected error.

### Requisits previs

*   Arxiu **.jar** a executar
*   Tiquet JIRA
*   Excel que trobarem al mateix tiquet.

### Passos perquè funcioni correctament

*   Obrim l'Excel i ens fixem en la  columna "PROCEDIMIENTO ENTE" hem de fer que aquesta columna sigui de tipus text.
    *   Perquè sigui tipus text podem afegir un apòstrof davant.
*   Perquè el fitxer **.jar** funcioni hem de guardar l'Excel amb l'extensió **.xls**.
*   Copiem el nom del full d'Excel on tenim les dades, ho necessitarem més endavant.

Una vegada hem fet tot això podem executar el fitxer **.jar**.

### Com executar l'arxiu .jar:

*   Obrim CMD
*   Ens dirigim a la ruta on tenim guardat l'arxiu **.jar**
*   Executem el fitxer amb la següent comanda: **java -jar AltaSIA.jar** (Pot variar depenent de com tenim guardat el fitxer)

El script ens farà les següents preguntes:

*   **Indica l'entorn (PRE/PRO)**→ Informem l'entorn en que volem fer la càrrega.
*   **Indica l'Excel que es vol carregar**→ Indiquem la ruta, exemple: C:\\Users\\rjuradog\\Documents\\Documentos\\18 Altes SIA\\3.xls
*   **Indica el nom de la fulla a tractar**→ Indiquem el nom del full que hem copiat previàment.

  

Error: NullPointerException

És possible que en alguna ocasió aparegui aquest error:

![](attachments/26313296/41520674.png)

Aquest problema es produeix a causa que l'arxiu Excel presenta algun espai en blanc en la fila següent a l'última fila que conté dades (en aquest cas a la fila numero 7).

![](attachments/26313296/41520669.png)

Per tal de **SOLUCIONAR-LO**, farem **botó dret sobre el número de la fila** i li donarem a **eliminar**.

  

  

  

Quan hàgim acabat ens donarà un procedure per executar-ho a la base de dades **SCSP PRO**. (Les dades les podem trobar al KeePass). **Hem de fixar-nos que el procedure que ens retorna coincideix amb les dades que hi havia a l'Excel.**

Copiem el procedure i ens dirigim al PLSQL Developer. Base de datos **SCSP PRO**

*   **SQL Developer**  
    Si executem el script des d'aquest programa (SQL Developer) copiem tal qual i executem el procedure
    
    `SET SERVEROUTPUT ON`  
    `BEGIN`  
    `altasia(``'S7800001E'``,``'Comunidad de Madrid'``,``'PA2634'``,``'TRIBUT'``,``'SVDSCTFNWS01'``,` `'5'``);`  
    `altasia(``'S7800001E'``,``'Comunidad de Madrid'``,``'PA2414'``,``'TRIBUT'``,``'SVDSCTFNWS01'``,` `'5'``);`  
    `END`
    
*   PLSQL Developer   
    Si executem el script des d'aquest programa (PLSQL Developer) copiem des de "BEGIN" fins a "END" i afegim un ";".
    
    `BEGIN`  
    `altasia(``'S7800001E'``,``'Comunidad de Madrid'``,``'PA2634'``,``'TRIBUT'``,``'SVDSCTFNWS01'``,` `'5'``);`  
    `altasia(``'S7800001E'``,``'Comunidad de Madrid'``,``'PA2414'``,``'TRIBUT'``,``'SVDSCTFNWS01'``,` `'5'``);`  
    `END;`
    

Una vegada feta la consulta, fem commit de la base de dades perquè s'actualitzi

![](attachments/26313296/128647394.png)

Una vegada finalitzat podem comentar el tiquet del JIRA.

Missatge tipus per tancar el tiquet

Bona tarda,

Hem realitzat la càrrega d'autoritzacions del ministeri.

Salutacions.

Attachments:
------------

![](images/icons/bullet_blue.gif) [AltesSIA.jar](attachments/26313296/26315335.jar) (application/java-archive)  
![](images/icons/bullet_blue.gif) [image2019-7-5\_14-9-12.png](attachments/26313296/26315928.png) (image/png)  
![](images/icons/bullet_blue.gif) [Excel exemple.xlsx](attachments/26313296/26315923.xlsx) (application/vnd.openxmlformats-officedocument.spreadsheetml.sheet)  
![](images/icons/bullet_blue.gif) [image2019-7-5\_14-13-21.png](attachments/26313296/26315925.png) (image/png)  
![](images/icons/bullet_blue.gif) [image2019-7-5\_14-16-52.png](attachments/26313296/26315924.png) (image/png)  
![](images/icons/bullet_blue.gif) [image2021-2-2\_11-2-12.png](attachments/26313296/41520668.png) (image/png)  
![](images/icons/bullet_blue.gif) [EspaiEnBlanc.png](attachments/26313296/41520669.png) (image/png)  
![](images/icons/bullet_blue.gif) [MicrosoftTeams-image.png](attachments/26313296/41520674.png) (image/png)  
![](images/icons/bullet_blue.gif) [image2025-4-9\_18-6-25.png](attachments/26313296/128647394.png) (image/png)  

Document generated by Confluence on 02 June 2025 10:47

[Atlassian](http://www.atlassian.com/)