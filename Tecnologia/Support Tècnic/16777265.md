Suport Tècnic : MUX - INTEGRACIÓ - Altes de Serveis MUX  

1.  [Suport Tècnic](index.md)
2.  [Suport Tècnic](13893782.md)
3.  [02 - FAQ's serveis](26313393.md)
4.  [FAQ's MUX](28705591.md)

Suport Tècnic : MUX - INTEGRACIÓ - Altes de Serveis MUX
=======================================================

Created by David Tejada, last modified by Unknown User (oteccmorales) on 13 August 2020

Establim dos mètodes per l'alta del servei.

Servei de MUX propi (integració)
--------------------------------

Les altes es realitzen per seguretat a través de la BBDD directament.

  

### Creació del registre a través de la BBDD

Si es tracta amb Timestamp Signature:

/\*

Crear nou registre

\*/

Insert into AOC\_MUX\_REGISTRES (ID,NOM,TIPUS,URL,TIMEOUT,HTTP\_BASIC\_AUTH\_ENABLE,HTTP\_USER,HTTP\_PASSWORD,WSS\_ENABLE,WSS\_OUTBOUND\_POLICY,WSS\_INBOUND\_POLICY,KEY\_ALIAS,KEY\_PASSWORD,OUTBOUND\_KEY\_IDENTIFIER,INBOUND\_KEY\_IDENTIFIER,TRUSTSTORE\_PROPERTIES,TRUSTSTORE\_PASSWORD,KEYSTORE\_PROPERTIES,KEYSTORE\_PASSWORD,SIGNATURE\_PARTS) values 
(mux\_id\_sequence.nextval,'NOM - Ajuntament ','REFERENCIA','URL-Ajuntament',
'30000','0',null,null,'1','Timestamp Signature',
'Signature Timestamp',
'segellconsorciaoc','2ESfRXIb','DirectReference','ThumbprintSHA1','/apps/aoc/IOP/prjMUX/MUX-reg\_referencia-truststore.properties','trust','/apps/aoc/IOP/prjMUX/MUX-reg\_referencia-keystore.properties','2ESfRXIb','{Element}{http://schemas.xmlsoap.org/soap/envelope/}Body;{Element}{http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd}Timestamp');
.rwui\_text\_box.rwui\_id\_5903cf86-4159-4220-ae63-63026137d51e {background-color: #F2F2F2; color: #666666;}.rwui\_text\_box.rwui\_id\_5903cf86-4159-4220-ae63-63026137d51e \*:not(.rwui\_content) {color: #666666;}.rwui\_text\_box.rwui\_id\_5903cf86-4159-4220-ae63-63026137d51e span.rwui\_icon {color: #666666;}

  

Un cop creat podem veure el seu identificador:

select \* from aoc\_mux\_registres order by id desc;

.rwui\_text\_box.rwui\_id\_d6257e2c-3286-4b33-860c-c0f1ea0c7deb {background-color: #F2F2F2; color: #666666;}.rwui\_text\_box.rwui\_id\_d6257e2c-3286-4b33-860c-c0f1ea0c7deb \*:not(.rwui\_content) {color: #666666;}.rwui\_text\_box.rwui\_id\_d6257e2c-3286-4b33-860c-c0f1ea0c7deb span.rwui\_icon {color: #666666;}

  

Amb l'ID proporcionat podem utilitzar el següent script per crear les regles:

\-- Pujem totes les regles el nombre de posicions de registres nous que crearem \* 2.

update aoc\_mux\_regles\_registres set ordre=ordre+2 where ordre>19;

-- ENS-> idRegistre

insert into aoc\_mux\_regles\_registres (id,regla,nom,registre\_desti,registre\_auxiliar,ordre)
values (mux\_id\_sequence.nextval,'\*:\*:ENT:\*:\*:ADM+I10~INE10ENS~:\*', 'ENS/E', idRegistre,1,20);

insert into aoc\_mux\_regles\_registres (id,regla,nom,registre\_desti,registre\_auxiliar, ordre)
values (mux\_id\_sequence.nextval,'\*:\*:SOR:ADM+I10~INE10ENS~:\*:\*:\*','ENS/S', idRegistre,1,21);

commit;

.rwui\_text\_box.rwui\_id\_cb3bea3d-c45a-41dc-a8f2-6a8bb0ea977f {background-color: #F2F2F2; color: #666666;}.rwui\_text\_box.rwui\_id\_cb3bea3d-c45a-41dc-a8f2-6a8bb0ea977f \*:not(.rwui\_content) {color: #666666;}.rwui\_text\_box.rwui\_id\_cb3bea3d-c45a-41dc-a8f2-6a8bb0ea977f span.rwui\_icon {color: #666666;}

  

Afegir ens a regles existents
-----------------------------

Farem una cerca de les regles implicades:

ERES-GENERIC: 

select \* from aoc\_mux\_regles\_registres where nom like '%ERES-GENERIC%' order by length(regla), nom;

.rwui\_text\_box.rwui\_id\_be8cba75-0cdc-4b7d-9e1c-5fc721e5d059 {background-color: #F2F2F2; color: #666666;}.rwui\_text\_box.rwui\_id\_be8cba75-0cdc-4b7d-9e1c-5fc721e5d059 \*:not(.rwui\_content) {color: #666666;}.rwui\_text\_box.rwui\_id\_be8cba75-0cdc-4b7d-9e1c-5fc721e5d059 span.rwui\_icon {color: #666666;}

  

Diputació de Tarragona:

select \* from aoc\_mux\_regles\_registres where nom like '%DIPTARRAGONA%' order by length(regla), nom;

.rwui\_text\_box.rwui\_id\_1b28e92f-44a0-4c7d-b635-5b9230a121d6 {background-color: #F2F2F2; color: #666666;}.rwui\_text\_box.rwui\_id\_1b28e92f-44a0-4c7d-b635-5b9230a121d6 \*:not(.rwui\_content) {color: #666666;}.rwui\_text\_box.rwui\_id\_1b28e92f-44a0-4c7d-b635-5b9230a121d6 span.rwui\_icon {color: #666666;}

  

Diputació de Girona(ERES):

select \* from aoc\_mux\_regles\_registres where nom like '%ERES-DIGI-GENERIC%' order by length(regla), nom;

.rwui\_text\_box.rwui\_id\_f3326183-7968-4723-902e-66df0155c6f7 {background-color: #F2F2F2; color: #666666;}.rwui\_text\_box.rwui\_id\_f3326183-7968-4723-902e-66df0155c6f7 \*:not(.rwui\_content) {color: #666666;}.rwui\_text\_box.rwui\_id\_f3326183-7968-4723-902e-66df0155c6f7 span.rwui\_icon {color: #666666;}

  

Diputació de Girona(Propi):

select \* from aoc\_mux\_regles\_registres where nom like '%DIPU-GIRONA%' order by length(regla), nom;

.rwui\_text\_box.rwui\_id\_5d887e59-bef8-4c42-9db7-24f81cb05afa {background-color: #F2F2F2; color: #666666;}.rwui\_text\_box.rwui\_id\_5d887e59-bef8-4c42-9db7-24f81cb05afa \*:not(.rwui\_content) {color: #666666;}.rwui\_text\_box.rwui\_id\_5d887e59-bef8-4c42-9db7-24f81cb05afa span.rwui\_icon {color: #666666;}

  

Diputació de Lleida:

select \* from aoc\_mux\_regles\_registres where nom like '%DIPU-LLEIDA%' order by length(regla), nom;

.rwui\_text\_box.rwui\_id\_811df025-ca2b-419a-91c3-9e8dcaf9142c {background-color: #F2F2F2; color: #666666;}.rwui\_text\_box.rwui\_id\_811df025-ca2b-419a-91c3-9e8dcaf9142c \*:not(.rwui\_content) {color: #666666;}.rwui\_text\_box.rwui\_id\_811df025-ca2b-419a-91c3-9e8dcaf9142c span.rwui\_icon {color: #666666;}

  

Seleccionem les dues regles a modificar i agafem el valor del camp REGLA.

I afegirem els INE10 dels ens que volem afegir amb la següent nomenclatura

|\\bINE10\\b

  

Un cop preparat, farem l'update amb la següent comanda:

update aoc\_mux\_regles\_registres set regla='NOVAREGLA' where id='IDENTIFICADOR\_E';
update aoc\_mux\_regles\_registres set regla='NOVAREGLA' where id='IDENTIFICADOR\_S';

.rwui\_text\_box.rwui\_id\_59424895-2ed8-49ff-a180-79f53440e370 {background-color: #F2F2F2; color: #666666;}.rwui\_text\_box.rwui\_id\_59424895-2ed8-49ff-a180-79f53440e370 \*:not(.rwui\_content) {color: #666666;}.rwui\_text\_box.rwui\_id\_59424895-2ed8-49ff-a180-79f53440e370 span.rwui\_icon {color: #666666;}

  

Abans de fer l'update de les regles, hem de revisar que no estigui l'ens en alguna regla existent.

  

Si existeix, podem utilitzar la següent query per fer l'update de les regles per eliminar-ho.

update aoc\_mux\_regles\_registres set regla=replace(regla,'\\b|\\b\_INE10\_\\b','\\b') where regla like '%\\b\_INE10\_%';

.rwui\_text\_box.rwui\_id\_3cdb5610-af72-4335-a75e-6f08184ec9e5 {background-color: #F2F2F2; color: #666666;}.rwui\_text\_box.rwui\_id\_3cdb5610-af72-4335-a75e-6f08184ec9e5 \*:not(.rwui\_content) {color: #666666;}.rwui\_text\_box.rwui\_id\_3cdb5610-af72-4335-a75e-6f08184ec9e5 span.rwui\_icon {color: #666666;}

Si no actualitza cap regla, podria ser que estigués com el primer de la regla, per tant, hauríem d'utilitzar la següent query:

update aoc\_mux\_regles\_registres set regla=replace(regla,'\\b\_INE10\_\\b','') where regla like '%\\b\_INE10\_%';

.rwui\_text\_box.rwui\_id\_1a4a6b1c-e80c-4647-988d-66a6b94df7ef {background-color: #F2F2F2; color: #666666;}.rwui\_text\_box.rwui\_id\_1a4a6b1c-e80c-4647-988d-66a6b94df7ef \*:not(.rwui\_content) {color: #666666;}.rwui\_text\_box.rwui\_id\_1a4a6b1c-e80c-4647-988d-66a6b94df7ef span.rwui\_icon {color: #666666;}

Adjunto un exemple per tal que quedi clar

/\*
ERES - GENERIC

4300380001 - Ajuntament de l'Albiol
4301730008 - Ajuntament de l'Argentera

|\\b4300380001\\b|\\b4301730008\\b

\*/

update aoc\_mux\_regles\_registres set regla='\*:\*:ENT:\*:\*:ADM+I10~\\b4306910007\\b|\\b4308590004\\b|\\b0820740003\\b|\\b2513270005\\b|\\b4311530008\\b|\\b2514310007\\b|\\b0814020002\\b|\\b8103503014\\b|\\b2517650006\\b|\\b0890580001\\b|\\b0822050006\\b|\\b0829560009\\b|\\b0823310007\\b|\\b0804590004\\b|\\b0824760009\\b|\\b9006360009\\b|\\b4313590004\\b|\\b0815090004\\b|\\b2519300000\\b|\\b9821080001\\b|\\b0801553059\\b|\\b0810940003\\b|\\b0824230008\\b|\\b8104240003\\b|\\b0822700000\\b|\\b4300380001\\b|\\b4301730008\\b~:\*' where id='213';

update aoc\_mux\_regles\_registres set regla='\*:\*:SOR:ADM+I10~\\b4306910007\\b|\\b4308590004\\b|\\b0820740003\\b|\\b2513270005\\b|\\b4311530008\\b|\\b2514310007\\b|\\b0814020002\\b|\\b8103503014\\b|\\b2517650006\\b|\\b0890580001\\b|\\b0822050006\\b|\\b0829560009\\b|\\b0823310007\\b|\\b0804590004\\b|\\b0824760009\\b|\\b9006360009\\b|\\b4313590004\\b|\\b0815090004\\b|\\b2519300000\\b|\\b9821080001\\b|\\b0801553059\\b|\\b0810940003\\b|\\b0824230008\\b|\\b8104240003\\b|\\b0822700000\\b|\\b4300380001\\b|\\b4301730008\\b~:\*:\*:\*' where id='214';

commit;

.rwui\_text\_box.rwui\_id\_34e960a1-a4ef-48ba-b2e6-678e1f7e4ccd {background-color: #F2F2F2; color: #666666;}.rwui\_text\_box.rwui\_id\_34e960a1-a4ef-48ba-b2e6-678e1f7e4ccd \*:not(.rwui\_content) {color: #666666;}.rwui\_text\_box.rwui\_id\_34e960a1-a4ef-48ba-b2e6-678e1f7e4ccd span.rwui\_icon {color: #666666;}

  

En les carpetes dels desplegaments \\\\venus\\Desplegaments\\2016\\MES\\DIA d'un dia qualsevol de PRO existeixen exemples. Estan ubicats sempre sota la carpeta PRO@MUX.

Un cop executat l'script cal fer el redeploy del MUX.

Document generated by Confluence on 02 June 2025 10:56

[Atlassian](http://www.atlassian.com/)