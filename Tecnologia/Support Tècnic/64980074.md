Suport Tècnic : SIR 2.0 - FLUX DEL SERVEI - Error en generar el rebut en confirmar un tràmit  

1.  [Suport Tècnic](index.md)
2.  [Suport Tècnic](13893782.md)
3.  [02 - FAQ's serveis](26313393.md)
4.  [FAQ's SIR 2.0](41523073.md)

Suport Tècnic : SIR 2.0 - FLUX DEL SERVEI - Error en generar el rebut en confirmar un tràmit
============================================================================================

Created by Unknown User (otecobernal), last modified on 21 September 2022

Explicació

Quan un usuari confirma un tràmit, durant el procés de confirmació, es genera un **rebut** en format PDF, que queda associat al mateix tràmit. A més a més, aquest document se signa utilitzant el certificat de l'AOC, que haurà d'estar carregat a l'entorn de l'**SSC** amb el rol **OVER**:

![](attachments/64980074/64980091.png)

  

No obstant això, l'èxit en el procés de confirmació no implica que el rebut es generi correctament, i ens podem trobar casos com el següent, on el tràmit està confirmat, però no hi ha cap rebut associat.

![](attachments/64980074/64980093.png)

Petició contra l'SSC (MSC - CREAR\_SIGNATURA)
---------------------------------------------

Internament, el procés de generació del rebut es recolza sobre una petició de signatura contra el TrustedX amb el rol d'OVER. Podrem buscar la petició filtrant per la data de confirmació del tràmit:

![](attachments/64980074/64980088.png)

Es poden donar 3 casuístiques perquè es produeixi aquest error:

*   L'SSC no estava operatiu, per tant, no trobarem cap petició al MSC, ja que no es van enregistrar (servei apagat).
*   L'SSC estava operatiu, però no estava funcionant correctament, per tant, és possible que trobem peticions que triguen molt temps i que finalitzen en error.
*   L'SSC estava col·lapsat i va trigar més del compte en donar resposta. En aquests casos el servei signa correctament el document, però triga tant que el SIR ho descarta (TimeOut) i no adjunta el document de rebut. En aquests casos podem trobar el PDF signat a la resposta de la petició del MSC.

Error als logs
--------------

Podrem buscar la traça d'error als logs del SOA (**MC-SIR\_APPNODO?\_SOA.log**):

Traça d'error...

08 Feb 2022 08:33:38,476 ERROR SIRMngr : [javax.xml.ws](http://javax.xml.ws).WebServiceException: [java.net](http://java.net).SocketTimeoutException: Read time out after 50000 millis  
at [com.sun.xml.ws](http://com.sun.xml.ws).transport.http.client.HttpClientTransport.readResponseCodeAndMessage(HttpClientTransport.java:210)  
at [com.sun.xml.ws](http://com.sun.xml.ws).transport.http.client.HttpTransportPipe.createResponsePacket(HttpTransportPipe.java:241)  
at [com.sun.xml.ws](http://com.sun.xml.ws).transport.http.client.HttpTransportPipe.process(HttpTransportPipe.java:232)  
at weblogic.wsee.jaxws.transport.http.client.WLSHttpTransportPipe.process(WLSHttpTransportPipe.java:30)  
at [com.sun.xml.ws](http://com.sun.xml.ws).transport.http.client.HttpTransportPipe.processRequest(HttpTransportPipe.java:145)  
at [com.sun.xml.ws](http://com.sun.xml.ws).transport.DeferredTransportPipe.processRequest(DeferredTransportPipe.java:139)  
at [com.sun.xml.ws](http://com.sun.xml.ws).api.pipe.Fiber.\_\_doRun(Fiber.java:1136)  
at [com.sun.xml.ws](http://com.sun.xml.ws).api.pipe.Fiber.\_doRun(Fiber.java:1050)  
at [com.sun.xml.ws](http://com.sun.xml.ws).api.pipe.Fiber.doRun(Fiber.java:1019)  
at [com.sun.xml.ws](http://com.sun.xml.ws).api.pipe.Fiber.runSync(Fiber.java:877)  
at [com.sun.xml.ws](http://com.sun.xml.ws).client.Stub.process(Stub.java:463)  
at [com.sun.xml.ws](http://com.sun.xml.ws).client.sei.SEIStub.doProcess(SEIStub.java:191)  
at [com.sun.xml.ws](http://com.sun.xml.ws).client.sei.SyncMethodHandler.invoke(SyncMethodHandler.java:108)  
at [com.sun.xml.ws](http://com.sun.xml.ws).client.sei.SyncMethodHandler.invoke(SyncMethodHandler.java:92)  
at [com.sun.xml.ws](http://com.sun.xml.ws).client.sei.SEIStub.invoke(SEIStub.java:161)  
at com.sun.proxy.$Proxy617.procesa(Unknown Source)  
at sun.reflect.GeneratedMethodAccessor2991.invoke(Unknown Source)  
at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)  
at java.lang.reflect.Method.invoke(Method.java:498)  
at weblogic.wsee.jaxws.spi.ClientInstanceInvocationHandler.invoke(ClientInstanceInvocationHandler.java:147)  
at com.sun.proxy.$Proxy618.procesa(Unknown Source)  
at cat.aoc.pci30.core.msc.client.MSCClient.procesa(MSCClient.java:36)  
at cat.aoc.pci30.core.msc.client.MSCClient.procesa(MSCClient.java:29)  
at cat.aoc.pci30.modalitats.sir.serveis.MSC.signaPdf(MSC.java:41)  
at cat.aoc.pci30.modalitats.sir.serveis.Rebut.generaRebutConfirmacio(Rebut.java:742)  
at cat.aoc.pci30.modalitats.sir.managers.SIRMngr.generaRebutConfirmacio(SIRMngr.java:305)  
at cat.aoc.pci30.modalitats.sir.managers.SIRMngr.confirma(SIRMngr.java:277)  
at cat.aoc.pci30.modalitats.sir.SIRModalitats.procesa(SIRModalitats.java:57)  
at cat.aoc.pci30.core.mti.fases.MTIFase4Impl.procesa(MTIFase4Impl.java:34)  
at sun.reflect.GeneratedMethodAccessor1822.invoke(Unknown Source)  
at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)  
at java.lang.reflect.Method.invoke(Method.java:498)  
at weblogic.wsee.jaxws.WLSInstanceResolver$WLSInvoker.invoke(WLSInstanceResolver.java:120)  
at weblogic.wsee.jaxws.WLSInstanceResolver$WLSInvoker.invoke(WLSInstanceResolver.java:93)  
at [com.sun.xml.ws](http://com.sun.xml.ws).server.InvokerTube$2.invoke(InvokerTube.java:149)  
at [com.sun.xml.ws](http://com.sun.xml.ws).server.sei.SEIInvokerTube.processRequest(SEIInvokerTube.java:88)  
at [com.sun.xml.ws](http://com.sun.xml.ws).api.pipe.Fiber.\_\_doRun(Fiber.java:1136)  
at [com.sun.xml.ws](http://com.sun.xml.ws).api.pipe.Fiber.\_doRun(Fiber.java:1050)  
at [com.sun.xml.ws](http://com.sun.xml.ws).api.pipe.Fiber.doRun(Fiber.java:1019)  
at [com.sun.xml.ws](http://com.sun.xml.ws).api.pipe.Fiber.runSync(Fiber.java:877)  
at [com.sun.xml.ws](http://com.sun.xml.ws).server.WSEndpointImpl$2.process(WSEndpointImpl.java:419)  
at [com.sun.xml.ws](http://com.sun.xml.ws).transport.http.HttpAdapter$HttpToolkit.handle(HttpAdapter.java:868)  
at [com.sun.xml.ws](http://com.sun.xml.ws).transport.http.HttpAdapter.handle(HttpAdapter.java:422)  
at [com.sun.xml.ws](http://com.sun.xml.ws).transport.http.servlet.ServletAdapter.handle(ServletAdapter.java:169)  
at weblogic.wsee.jaxws.WLSServletAdapter.handle(WLSServletAdapter.java:246)  
at weblogic.wsee.jaxws.HttpServletAdapter$AuthorizedInvoke.run(HttpServletAdapter.java:667)  
at weblogic.security.acl.internal.AuthenticatedSubject.doAs(AuthenticatedSubject.java:386)  
at weblogic.security.service.SecurityManager.runAs(SecurityManager.java:163)  
at weblogic.wsee.util.ServerSecurityHelper.authenticatedInvoke(ServerSecurityHelper.java:108)  
at weblogic.wsee.jaxws.HttpServletAdapter$3.run(HttpServletAdapter.java:286)  
at weblogic.wsee.jaxws.HttpServletAdapter.post(HttpServletAdapter.java:295)  
at weblogic.wsee.jaxws.JAXWSServlet.doRequest(JAXWSServlet.java:128)  
at weblogic.servlet.http.AbstractAsyncServlet.service(AbstractAsyncServlet.java:103)  
at javax.servlet.http.HttpServlet.service(HttpServlet.java:790)  
at weblogic.servlet.internal.StubSecurityHelper$ServletServiceAction.run(StubSecurityHelper.java:295)  
at weblogic.servlet.internal.StubSecurityHelper$ServletServiceAction.run(StubSecurityHelper.java:260)  
at weblogic.servlet.internal.StubSecurityHelper.invokeServlet(StubSecurityHelper.java:137)  
at weblogic.servlet.internal.ServletStubImpl.execute(ServletStubImpl.java:353)  
at weblogic.servlet.internal.ServletStubImpl.execute(ServletStubImpl.java:250)  
at weblogic.servlet.internal.WebAppServletContext$ServletInvocationAction.wrapRun(WebAppServletContext.java:3793)  
at weblogic.servlet.internal.WebAppServletContext$ServletInvocationAction.run(WebAppServletContext.java:3763)  
at weblogic.security.acl.internal.AuthenticatedSubject.doAs(AuthenticatedSubject.java:344)  
at weblogic.security.service.SecurityManager.runAsForUserCode(SecurityManager.java:197)  
at weblogic.servlet.provider.WlsSecurityProvider.runAsForUserCode(WlsSecurityProvider.java:203)  
at weblogic.servlet.provider.WlsSubjectHandle.run(WlsSubjectHandle.java:71)  
at weblogic.servlet.internal.WebAppServletContext.doSecuredExecute(WebAppServletContext.java:2451)  
at weblogic.servlet.internal.WebAppServletContext.securedExecute(WebAppServletContext.java:2299)  
at weblogic.servlet.internal.WebAppServletContext.execute(WebAppServletContext.java:2277)  
at weblogic.servlet.internal.ServletRequestImpl.runInternal(ServletRequestImpl.java:1710)  
at weblogic.servlet.internal.ServletRequestImpl.run(ServletRequestImpl.java:1670)  
at weblogic.servlet.provider.ContainerSupportProviderImpl$WlsRequestExecutor.run(ContainerSupportProviderImpl.java:272)  
at weblogic.invocation.ComponentInvocationContextManager.\_runAs(ComponentInvocationContextManager.java:352)  
at weblogic.invocation.ComponentInvocationContextManager.runAs(ComponentInvocationContextManager.java:337)  
at weblogic.work.LivePartitionUtility.doRunWorkUnderContext(LivePartitionUtility.java:57)  
at weblogic.work.PartitionUtility.runWorkUnderContext(PartitionUtility.java:41)  
at weblogic.work.SelfTuningWorkManagerImpl.runWorkUnderContext(SelfTuningWorkManagerImpl.java:655)  
at weblogic.work.ExecuteThread.execute(ExecuteThread.java:420)  
at weblogic.work.ExecuteThread.run(ExecuteThread.java:360)  
Caused by: [java.net](http://java.net).SocketTimeoutException: Read time out after 50000 millis  
at weblogic.socket.NIOInputStream.readInternal(NIOInputStream.java:177)  
at weblogic.socket.NIOInputStream.read(NIOInputStream.java:110)  
at weblogic.socket.NIOInputStream.read(NIOInputStream.java:73)  
at [java.io](http://java.io).BufferedInputStream.fill(BufferedInputStream.java:246)  
at [java.io](http://java.io).BufferedInputStream.read1(BufferedInputStream.java:286)  
at [java.io](http://java.io).BufferedInputStream.read(BufferedInputStream.java:345)  
at [weblogic.net](http://weblogic.net).http.MessageHeader.isHTTP(MessageHeader.java:310)  
at [weblogic.net](http://weblogic.net).http.MessageHeader.parseHeader(MessageHeader.java:232)  
at [weblogic.net](http://weblogic.net).http.HttpClient.parseHTTP(HttpClient.java:556)  
at [weblogic.net](http://weblogic.net).http.HttpURLConnection.getInputStream(HttpURLConnection.java:757)  
at [weblogic.net](http://weblogic.net).http.SOAPHttpURLConnection.getInputStream(SOAPHttpURLConnection.java:42)  
at [weblogic.net](http://weblogic.net).http.HttpURLConnection.getResponseCode(HttpURLConnection.java:1616)  
at [com.sun.xml.ws](http://com.sun.xml.ws).transport.http.client.HttpClientTransport.readResponseCodeAndMessage(HttpClientTransport.java:206)  
... 77 more

08 Feb 2022 08:33:38,476 DEBUG SIRModalitats : <?xml version="1.0" encoding="UTF-8"?>  
<respostaConfirmacioAssentament xmlns="[http://www.aoc.cat/sir](http://www.aoc.cat/sir)">  
<peticioConfirmacioAssentament>  
<idEnviamentSIR>O00000318\_22\_25745068</idEnviamentSIR>  
</peticioConfirmacioAssentament>  
<resposta>  
<registreEntrada>LLEAJT/2022017842</registreEntrada>  
<registreEntradaData>20220208083233</registreEntradaData>  
</resposta>  
<resultat>  
<codiResultat>0</codiResultat>  
<descripcio></descripcio>  
</resultat>  
</respostaConfirmacioAssentament>

  

Tràmits afectats:
-----------------

Al principi no es generava rebut, per tant, haurem de tenir en compte que els primers tràmits generats amb el SIR no tindran rebut associat, ja que la "feature" no estava desenvolupada.

Podrem veure els tràmits que no tenen el rebut associat com a annex:

**Tràmits afectats per un ens en una data**

select \*
  from SIR\_PCI.sir\_intercanvi sir
 where sir.codi\_ens = '827980001'
   and sir.estat = 2
   and sir.tipus = 1
   and sir.DATA > sysdate - 30
   and not exists (select doc.id
          from SIR\_PCI.sir\_annex doc
         where doc.NOM like '%rebut%'
           and doc.ID\_INTERCANVI = sir.id);

  

Solució:
--------

De moment no hi ha una solució o resposta per l'usuari. S'ha de revisar internament ST + PRJ + Cap de Servei per veure com tractar aquest tipus d'incidències.

**MIssatge tipus**

Bon dia,

Els rebuts del SIR es podran generar de manera asíncrona amb la nova versió del servei (SIR4).

Encara no hi ha data de sortida de la nova versió, però tenim aquest tema apuntat.

Si us sembla bé, us enviarem un correu a la bústia informada quan el nou servei estigui operatiu i procedim a tancar aquesta incidència.

Salutacions i disculpeu les molèsties.

  

Attachments:
------------

![](images/icons/bullet_blue.gif) [image2022-1-11\_12-13-42.png](attachments/64980074/64980075.png) (image/png)  
![](images/icons/bullet_blue.gif) [image2022-1-11\_12-12-59.png](attachments/64980074/64980076.png) (image/png)  
![](images/icons/bullet_blue.gif) [image2021-5-17\_11-48-23.png](attachments/64980074/64980077.png) (image/png)  
![](images/icons/bullet_blue.gif) [image2021-5-19\_13-47-3.png](attachments/64980074/64980078.png) (image/png)  
![](images/icons/bullet_blue.gif) [image2021-5-19\_13-36-41.png](attachments/64980074/64980079.png) (image/png)  
![](images/icons/bullet_blue.gif) [image2021-5-19\_13-35-20.png](attachments/64980074/64980080.png) (image/png)  
![](images/icons/bullet_blue.gif) [image2021-5-17\_12-1-4.png](attachments/64980074/64980081.png) (image/png)  
![](images/icons/bullet_blue.gif) [image2021-5-17\_12-0-6.png](attachments/64980074/64980082.png) (image/png)  
![](images/icons/bullet_blue.gif) [image2021-5-17\_11-59-38.png](attachments/64980074/64980083.png) (image/png)  
![](images/icons/bullet_blue.gif) [image2021-5-17\_11-56-48.png](attachments/64980074/64980084.png) (image/png)  
![](images/icons/bullet_blue.gif) [image2021-5-17\_11-47-42.png](attachments/64980074/64980085.png) (image/png)  
![](images/icons/bullet_blue.gif) [image2021-5-17\_10-44-6.png](attachments/64980074/64980086.png) (image/png)  
![](images/icons/bullet_blue.gif) [image2022-2-10\_16-40-35.png](attachments/64980074/64980087.png) (image/png)  
![](images/icons/bullet_blue.gif) [image2022-2-10\_17-2-56.png](attachments/64980074/64980088.png) (image/png)  
![](images/icons/bullet_blue.gif) [image2022-2-10\_17-21-13.png](attachments/64980074/64980091.png) (image/png)  
![](images/icons/bullet_blue.gif) [image2022-2-10\_17-27-5.png](attachments/64980074/64980093.png) (image/png)  

Document generated by Confluence on 02 June 2025 10:59

[Atlassian](http://www.atlassian.com/)