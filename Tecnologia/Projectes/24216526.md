Projectes : Eliminar el segell de temps d'una signatura CAdES  

1.  [Projectes](index.md)
2.  [PSIS](PSIS_24215797.md)
3.  [PSIS - WIKI](PSIS---WIKI_24215598.md)
4.  [Sample code](Sample-code_24215632.md)

Projectes : Eliminar el segell de temps d'una signatura CAdES
=============================================================

Created by √Åurea Alcaide on 30 julio 2019

import java.security.Security;
import java.util.Collection;
import java.util.Iterator;

import org.bouncycastle.asn1.ASN1ObjectIdentifier;
import org.bouncycastle.asn1.DERObjectIdentifier;
import org.bouncycastle.asn1.cms.AttributeTable;
import org.bouncycastle.cms.CMSSignedData;
import org.bouncycastle.cms.SignerInformation;
import org.bouncycastle.cms.SignerInformationStore;
import org.bouncycastle.jce.provider.BouncyCastleProvider;
import org.bouncycastle.util.encoders.Base64;

public class CAdESParserRemoveTimeStamp {

    public static void main(String\[\] args) {

        String signatureWithTs = "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";

        byte\[\] signatureNoTs = getTimeStampCertificate(Base64.decode(signatureWithTs));
        System.out.println(new String(Base64.encode(signatureNoTs)));

    }

    public static byte\[\] getTimeStampCertificate(byte\[\] signature){

        //BouncyCastle Provider
        Security.addProvider(new BouncyCastleProvider());

        try {
            CMSSignedData signedData = new CMSSignedData(signature);

            //signer infos
            SignerInformationStore signers = signedData.getSignerInfos();
            Collection<SignerInformation> signersCollection = signers.getSigners();
            Iterator<SignerInformation> signer\_iterator = signers.getSigners().iterator();

            while (signer\_iterator.hasNext()) {

                //informaci√≥ del signatari
                SignerInformation signer = signer\_iterator.next();            

                //timeStampToken -> OID: 1.2.840.113549.1.9.16.2.14
                if (signer.getUnsignedAttributes() != null && signer.getUnsignedAttributes().get(new DERObjectIdentifier("1.2.840.113549.1.9.16.2.14")) != null) {                    
                    ASN1ObjectIdentifier a = new ASN1ObjectIdentifier("1.2.840.113549.1.9.16.2.14");
                    AttributeTable table = signer.getUnsignedAttributes();
                    //remove timestamp from unsigned attributes table
                    table = table.remove(a);
                    signersCollection.remove(signer);
                    //regenerate signer without timestamp
                    signer = SignerInformation.replaceUnsignedAttributes(signer, table);
                    signersCollection.add(signer);
                    //new signer infos
                    SignerInformationStore signersNoTs = new SignerInformationStore(signersCollection);
                    //replace signers into signature
                    signedData = CMSSignedData.replaceSigners(signedData, signersNoTs);
                }                
            }

            return signedData.getEncoded();

        } catch (Exception e) {
            e.printStackTrace();
        }

        return null;

    }

}

  

Document generated by Confluence on 07 junio 2025 00:00

[Atlassian](http://www.atlassian.com/)