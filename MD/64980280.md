Suport Tècnic : Monitor S.T. - MUX - Peticions del MUX2 en estat d'error  

1.  [Suport Tècnic](index.html)
2.  [Suport Tècnic](13893782.html)
3.  [03 - Monitorització - Revisions globals](26313327.html)
4.  [Monitors S.T.](Monitors-S.T._41522177.html)
5.  [Monitor S.T. - OLD](Monitor-S.T.---OLD_118555256.html)

Suport Tècnic : Monitor S.T. - MUX - Peticions del MUX2 en estat d'error
========================================================================

Created by Unknown User (otecobernal), last modified by Unknown User (otecjriquelme) on 28 February 2022

Què mesura aquest monitor?

El monitor mira quin percentatge de peticions en error hi ha al MUX. Salta quan el percentatge sigui superior al 15%.

  

**Consulta**
============

* * *

SELECT  TRUNC(KO.KO/(KO.KO+OK.OK)\*100) "% kos"
  FROM 
  (SELECT count(\*) KO
           FROM MUX2.AOC\_MUX\_AUDIT\_DADES\_GENERALS 
          where (TRACE\_DATE > (SYSDATE - INTERVAL '15' MINUTE))
            AND ESTAT = 'KO'
            AND APLICACIO != 'DUMMY') KO,
                       
        (SELECT count(\*) +1 OK -- li sumem un 1 per no dividir mai entre 0
           FROM MUX2.AOC\_MUX\_AUDIT\_DADES\_GENERALS 
          where (TRACE\_DATE > (SYSDATE - INTERVAL '15' MINUTE))
            AND ESTAT = 'OK'
            AND APLICACIO != 'DUMMY') OK

**Procediment**
===============

* * *

Veurem tota la informació sobre els registres que han donat KO. Com per exemple data i hora, aplicació, procedència o destí.

SELECT \*
FROM MUX2.AOC\_MUX\_AUDIT\_DADES\_GENERALS
WHERE ESTAT = 'KO'
AND (TRACE\_DATE > (SYSDATE - INTERVAL '15' MINUTE))
AND APLICACIO != 'DUMMY'
 ORDER BY trace\_date desc;

Per agrupar els errors per aplicació:

SELECT aplicacio, COUNT(aplicacio)
FROM MUX2.AOC\_MUX\_AUDIT\_DADES\_GENERALS
WHERE ESTAT = 'KO'
AND (TRACE\_DATE > (SYSDATE - INTERVAL '15' minute))
AND APLICACIO != 'DUMMY'
  GROUP BY aplicacio;

Es tracta d'una sonda bastant general. L'actuació en aquest cas es basaria a fer l'anàlisi dels errors utilitzant la QUERY presentada a sobre. Analitzant la informació de cada una de les columnes podrem detectar si els KO's se centren en un/a destí/procedència concret/a o bé en un servei o bé en un interval de temps.

Per tal de revisar més a fons un error que registri la sonda, podem copiar l'ID únic de la taula i enganxar-lo a la web Admin del MUX → Auditoria de Peticions.

D'aquesta manera, podrem revisar els XML de petició i resposta i analitzar quin tipus d'error es retorna.

Pel que fa a revisions, també pot resultar útil llençar la següent QUERY, que ens mostrarà tots els registres del MUX (OK i KO) ordenats per hora, per tal de detectar pics d'errors que s'han donat en un moment puntual. També veurem si ara mateix les peticions s'estan tractant de manera normal al MUX.

SELECT \* FROM MUX2.AOC\_MUX\_AUDIT\_DADES\_GENERALS WHERE (TRACE\_DATE > (SYSDATE - INTERVAL '1' HOUR)) AND APLICACIO != 'DUMMY' ORDER BY TRACE\_DATE DESC

**Informació addicional**
=========================

* * *

### 1) Revisió de logs

Podrem trobar els logs a les rutes:

*   **Servidor:** 10.120.1.20
*   **Ruta:** /apps/aoc/IOP/logs
*   **Nom:**  MUX2\_${weblogic.Name}.log

  

  

Attachments:
------------

![](images/icons/bullet_blue.gif) [CORPME - Procés d'alta de serveiSuport Tècnic16 marzo 2020Procediment a realitzar setmanalment per les altes del CORPME. Guia.url](attachments/64980280/64980281.url) (application/octet-stream)  
![](images/icons/bullet_blue.gif) [cds.gif](attachments/64980280/64980282.gif) (image/gif)  

Document generated by Confluence on 02 June 2025 11:09

[Atlassian](http://www.atlassian.com/)