Suport Tècnic : Monitor S.T. - e-TAULER - Edictes no publicats en la data establerta (PL) - format incorrecte  

1.  [Suport Tècnic](index.html)
2.  [Suport Tècnic](13893782.html)
3.  [03 - Monitorització - Revisions globals](26313327.html)
4.  [03 - Monitorització - OLD](128647245.html)
5.  [Sondes S.T.](Sondes-S.T._30869120.html)
6.  [Sondes ST - Old](Sondes-ST---Old_41522507.html)

Suport Tècnic : Monitor S.T. - e-TAULER - Edictes no publicats en la data establerta (PL) - format incorrecte
=============================================================================================================

Created by OTEC ST Alessandro Trombin Martinez, last modified by Unknown User (otecobernal) on 23 November 2021

Consulta
========

SELECT count(ID) "Edictes no publicats"
  FROM ETAULER3PL.ET\_EDICTE
 WHERE SYSDATE > (DATA\_INICI\_EXPOSICIO + 15 / 24 / 60)
   AND ESTAT = 2
   AND (REINTENTS < 20 or reintents is null)
   AND DATA\_FI\_EXPOSICIO IS NOT NULL
   AND DATA\_FI\_EXPOSICIO > SYSDATE;

  

Procediment 
============

  

**Descripció:** 

Aquesta sonda consulta els edictes del PORTLET que no s'han publicat en la data establerta:

*   L'edicte està pendent de publicar (estat igual a 2).
*   La data de publicació és menor a la data actual amb un marge de 15 minuts.
*   La data de despublicació es major a la data actual.
*   L'edicte té 5 o més reintents, que significa que s'han realitzat tots els intents permesos.
*   L'edicte té menys de 20 reintents per no agafar edictes de la blacklist (entre altres casuístiques).

  

**Actuació:** 

Primer de tot localitzarem els edictes amb un estat incorrecte, en aquest cas, els que haurien d'estar publicats i no ho estan. Farem servir la següent consulta:

SELECT \* 
FROM ETAULER3PL.ET\_EDICTE 
WHERE SYSDATE > (DATA\_INICI\_EXPOSICIO + 15/24/60) 
AND ESTAT = 2 
AND (REINTENTS < 20 or reintents is null)
AND DATA\_FI\_EXPOSICIO > SYSDATE;

D'aquest llistat ens interessa el camp **ID**.

**![](attachments/41522789/41523373.png)**

Un cop tenim el llistat d'edictes, copiem tots els ID's.

Molt d'ull, ara canviem de BBDD, d'**ETAULER3PL** a **ETAULER3PCI**.

La següent consulta mostra el procés de **publicació** de tots els edictes que li indiquem.

Select pci.id\_edicte "ID PL", pci.reintents, proces.\*
  from etauler3pci.et\_edicte pci, etauler3pci.et\_proces proces
 where pci.id = proces.id\_edicte
   and pci.estat = '1'
   and pci.eacat = '1'
   and pci.reintents != '99'
   and pci.id\_edicte in ('234366', '654321', '123456'); --> Aquí posem els ID's de la primera consulta, es poden posar tants com vulguem.

Exemple d'un possible resultat quan executem la consulta anterior:

![](attachments/41522789/41523374.png)

**El més comú és que la base de dades de PCI i la de PL no se sincronitzin de manera correcta, és a dir, en PCI mostrarà l'estat correcte i en la PL mostrarà un estat incorrecte.**

**Per a solucionar aquesta casuística "forçarem" la sincronització canviant el camp SINCRONITZAT\_EACAT a 0.**

La següent consulta canvia l'estat del camp **SINCRONITZAT\_EACAT** dels processos que li indiquem a **0**.

Update etauler3pci.et\_proces proces
   set proces.sincronitzat\_eacat = '0'
 where id in ('363504'); --> Sempre informarem l'ID de la taula ETAULER3PCI.ET\_PROCES per evitar confusions.

**logs:** 

*   **Servidor:** Tomcat 8 - EACAT
*   **Ruta:** /mnt/storage30/aoc/APP/logs
*   **Nom:**  aoc-l-tomcat8-01-pro

Attachments:
------------

![](images/icons/bullet_blue.gif) [cds.gif](attachments/41522789/41522790.gif) (image/gif)  
![](images/icons/bullet_blue.gif) [image2020-1-15\_11-31-8.png](attachments/41522789/41523373.png) (image/png)  
![](images/icons/bullet_blue.gif) [image2020-1-15\_12-27-2.png](attachments/41522789/41523374.png) (image/png)  
![](images/icons/bullet_blue.gif) [Monitor S.T. - e-TAULER - Edictes no publicats en la data establerta (PL).url](attachments/41522789/64979206.url) (application/octet-stream)  

Document generated by Confluence on 02 June 2025 11:11

[Atlassian](http://www.atlassian.com/)