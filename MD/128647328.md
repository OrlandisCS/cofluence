Suport Tècnic : Alerta PCI / IOP Temps de processat  

1.  [Suport Tècnic](index.html)
2.  [Suport Tècnic](13893782.html)
3.  [03 - Monitorització - Revisions globals](26313327.html)
4.  [Dynatrace - Alertes de correu](Dynatrace---Alertes-de-correu_128647310.html)

Suport Tècnic : Alerta PCI / IOP Temps de processat
===================================================

Created by David Tejada on 04 April 2025

Existeix una alerta que ens avisa quan hi ha algun producte de IOP supera els 15s de promig durant uns minuts.

  

El correu que es rep és simular a aquest:

  

![](attachments/128647328/128647329.png)

  

En aquest cas, podem revisar el dashboard general de rendiment de IOP:

[https://aes56028.apps.dynatrace.com/ui/apps/dynatrace.dashboards/dashboard/9606ba3a-2b56-4349-94d6-2f6fe5f996be#from=-30m&to=now%28%29](https://aes56028.apps.dynatrace.com/ui/apps/dynatrace.dashboards/dashboard/9606ba3a-2b56-4349-94d6-2f6fe5f996be#from=-30m&to=now%28%29)

  

![](attachments/128647328/128647330.png)

  

Podem obtenir una gràfica només amb les que estan fallant primer executant aquest DQL:

fetch logs //, scanLimitGBytes: 500, samplingRatio: 1000  
| filter matchesValue(log.source, "/apps/splunk/splunk-IOPNODO#\_SOA.log")  
| filter contains (content, "CodigoProducto")  
| parse content, "LD 'IdPeticio=\\"' LD\*:IdPeticio '\\"' SPACE 'IdSolicitud=\\"' LD\*:IdSolicitud '\\"' SPACE 'Node=\\"' LD:Node '\\"' SPACE 'CodigoProducto=\\"' LD:CodigoProducto '\\"' SPACE 'CodigoCertificado=\\"' LD:CodigoCertificado '\\"' SPACE 'IdentificadorSolicitante=\\"' LD:IdentificadorSolicitante '\\"' SPACE 'IdSolicitanteOriginal=\\"' LD\*:IdSolicitanteOriginal '\\"' SPACE 'DataPeticio=\\"' LD:DataPeticio '\\"' SPACE 'DataResposta=\\"'LD:DataResposta '\\"' SPACE 'TempsProces=\\"' INT:TempsProces '\\"' SPACE 'Error=\\"' LD:Error '\\"' SPACE 'Missatge=\\"' LD\*:Missatge '\\"' SPACE 'Tipus=\\"' LD:Tipus '\\"' "  
| summarize promig=avg(TempsProces), by:{ CodigoProducto, bin(timestamp,5m)}  
| filter promig > 15000

![](attachments/128647328/128647332.png)

I si cal, podem extreure aquelles peticions que estan trigant més de X segons amb aquesta altre query:

  

fetch logs //, scanLimitGBytes: 500, samplingRatio: 1000  
| filter matchesValue(log.source, "/apps/splunk/splunk-IOPNODO#\_SOA.log")  
| filter contains (content, "CodigoProducto")  
| parse content, "LD 'IdPeticio=\\"' LD\*:IdPeticio '\\"' SPACE 'IdSolicitud=\\"' LD\*:IdSolicitud '\\"' SPACE 'Node=\\"' LD:Node '\\"' SPACE 'CodigoProducto=\\"' LD:CodigoProducto '\\"' SPACE 'CodigoCertificado=\\"' LD:CodigoCertificado '\\"' SPACE 'IdentificadorSolicitante=\\"' LD:IdentificadorSolicitante '\\"' SPACE 'IdSolicitanteOriginal=\\"' LD\*:IdSolicitanteOriginal '\\"' SPACE 'DataPeticio=\\"' LD:DataPeticio '\\"' SPACE 'DataResposta=\\"'LD:DataResposta '\\"' SPACE 'TempsProces=\\"' INT:TempsProces '\\"' SPACE 'Error=\\"' LD:Error '\\"' SPACE 'Missatge=\\"' LD\*:Missatge '\\"' SPACE 'Tipus=\\"' LD:Tipus '\\"' "  
| filter TempsProces > 10000

![](attachments/128647328/128647331.png)

  

En aquests casos, per cada servei, si es manté o s'incrementen les peticions que fallen, caldrà revisar en detall, si és un error de negoci controlat, o el servei està caigut a l'altre banda.

  

Aqui també podem veure patrons, si estan molts serveis del mateix endpoint (PICA / Minhap, etc..).

  

Attachments:
------------

![](images/icons/bullet_blue.gif) [image2025-4-4\_16-22-41.png](attachments/128647328/128647329.png) (image/png)  
![](images/icons/bullet_blue.gif) [image2025-4-4\_16-24-58.png](attachments/128647328/128647330.png) (image/png)  
![](images/icons/bullet_blue.gif) [image2025-4-4\_16-41-38.png](attachments/128647328/128647331.png) (image/png)  
![](images/icons/bullet_blue.gif) [image2025-4-4\_16-42-39.png](attachments/128647328/128647332.png) (image/png)  

Document generated by Confluence on 02 June 2025 11:11

[Atlassian](http://www.atlassian.com/)