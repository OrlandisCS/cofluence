Suport Tècnic : CDOMICILI - Comunicacions en estat d'error  

1.  [Suport Tècnic](index.md)
2.  [Suport Tècnic](13893782.md)
3.  [03 - Monitorització - Revisions globals](26313327.md)
4.  [03 - Monitorització - OLD](128647245.md)
5.  [Sondes S.T.](Sondes-S.T._30869120.md)
6.  [Sondes ST - Old](Sondes-ST---Old_41522507.md)
7.  [Sondes ST - CDOMICILI](Sondes-ST---CDOMICILI_28705209.md)

Suport Tècnic : CDOMICILI - Comunicacions en estat d'error
==========================================================

Created by Unknown User (otecobernal), last modified by Unknown User (otecagonzalez) on 23 November 2020

**Query:**

SELECT COUNT(t.ID) FROM CD\_COMUNICACIO c, CD\_TITULAR t WHERE c.ID\_TITULAR=t.ID AND c.ESTAT=0 AND c.INTENTS<=5 AND t.ESTAT!=0

**Descripció:** 

Sonda funcional del CDOMICILI. Monitora la segona fase del servei, on s'envia el volant d'empadronament de la persona que canviarà de domicili (TITULAR) a l'emissor (MINHAP, CATSALUT, etc).

La sonda mostra les comunicacions que es troben en estat d'error i estan pendents de processar per l'RDBMS o han arribat a 5 reintents. 

Podem extreure informació de l'ens que ha realitzat el consum amb la següent consulta:

SELECT ens.uen\_nom\_curt, proces.codi\_ens, count(\*) 
FROM CD\_TITULAR titular, CD\_PROCES proces, CD\_COMUNICACIO comunicacio, usu\_ens ens
WHERE proces.id = titular.id\_proces
AND proces.codi\_ens = ens.uen\_codi\_ens
AND comunicacio.ID\_TITULAR = titular.ID 
AND comunicacio.ESTAT = 0 
AND comunicacio.INTENTS <= 5 
AND titular.estat = 1
group by ens.uen\_nom\_curt, proces.codi\_ens
order by count(\*) desc

  
Per obtenir més informació de l'error, podem buscar les peticions (s'informen a la taula procés) a la web admin: [http://admin3.iop.aoc.cat/pci3-cdomicili-admin/](http://admin3.iop.aoc.cat/pci3-cdomicili-admin/comunicacions/11)

Un cop trobem la petició podrem veure la resposta de l'emissor de les dades (Sol·licitud → Evidències → Resposta)

  

**Actuació:** 

Aquesta sonda esta associada al **RDBMS CDOMICILI-COMUNICACIO**. Quan aquesta sonda té els registres molt alts hi ha dues possibles casuístiques:

1.  Que els registres tinguin menys de 5 reintents: Probablement l'RDBMS no es trobi operatiu → Revisar que l'RDBMS processi a través de la [consola](http://admin3.iop.aoc.cat/pci3-rdbmseg-admin/):  
    ![](attachments/28705222/28705228.png)
    
2.  Que els registres hagin arribat als reintents: S'haurà de revisar l'error als logs i veure perquè la comunicació no finalitza.
    
    Aquesta sonda està associada a una altra sonda del CDOMICILI (**CDOMICILI-Volants en estat d'error**). Si veiem que les dues presenten registres alts, haurem d'arreglar primer l'altra sonda.
    
    En cas de voler intentar fer la comunicació un altre cop:
    
    update CD\_COMUNICACIO t set intents = 4
    where t.ESTAT=0 AND t.INTENTS=5
    
    Els errors de l'emissor estan relacionats amb el VOLANT del padró. Haurem de revisar el VOLANT del padró per mirar que no hi hagin dades incorrectes codis no normalitzats per l'INE, caràcters extranys, etc.
    

**logs:** 

*   **Servidor:** tomcat8@aoc-l-eacat8-?-pro - 10.120.1.65 (node 1)
*   **Ruta:** /apps/aoc/IOP/logs
*   **Nom:**  MC-CDOMICILI\_IOPNODO?.log

  

  

Attachments:
------------

![](images/icons/bullet_blue.gif) [image2019-10-15\_12-0-19.png](attachments/28705222/28705223.png) (image/png)  
![](images/icons/bullet_blue.gif) [image2019-10-15\_13-12-2.png](attachments/28705222/28705227.png) (image/png)  
![](images/icons/bullet_blue.gif) [image2019-10-15\_13-12-17.png](attachments/28705222/28705228.png) (image/png)  

Document generated by Confluence on 02 June 2025 11:11

[Atlassian](http://www.atlassian.com/)