Projectes : Càrrega de claus de signatura  

1.  [Projectes](index.md)
2.  [PSIS](PSIS_24215797.md)
3.  [PSIS - WIKI](PSIS---WIKI_24215598.md)
4.  [Procediments](Procediments_24215610.md)

Projectes : Càrrega de claus de signatura
=========================================

Created by Áurea Alcaide, last modified on 08 julio 2019

**1.- Eliminar clau existent.**  
Per carregar una clau que substitueixi a una ja existent a punt de caducar, cal primer eliminar la que caducarà.  
Per eliminiar-la, aturar el servei, i executar el procedure Oracle:  
**DELETE\_OLD\_P12\_PRE**  
Abans d'executar-ho, cal substituir els valors del **subject** i el **certificate finger print** pels del certificat a eliminar.

**2.- Carregar la nova clau des de la consola java.**

  

**2.1.- Actualització arxius de bindings.**

Per tal de carregar la nova clau, cal actualitar els següents arxius amb la informació del nou P12:

**catcert-usersBinding-xxxxx.xml**:

<Binding xmlns="[http://www.netfocus.es/psis/management](http://www.netfocus.es/psis/management)">  
<Entity name=" **User\_iArxiu\_PRE** " domain=" **userEntity** " schema="X500BasedSchema">  
<Attribute name="X500Name">  
<Value> **_X500Name_** </Value>  
</Attribute>  
</Entity>  
<Key>  
<KeyPair>  
<StorePath>./psis-config/configuracio\_psis/bindings/P12s/ **_nom p12_** </StorePath>  
<StorePass> **_password_** </StorePass>  
</KeyPair>  
<Usages>  
<Usage name=" **Identifiers/KeyUsages/Signature** "/>  
</Usages>  
<Applications>  
<Application name="app\_name" URI="urn:ietf:rfc:2633"/>  
</Applications>  
</Key>  
<Certificate>  
<Encoding> **_cert en Base 64_** </Encoding>  
</Certificate>  
</Binding>

  

**IMPORTANT**: Per obtenir el X509Name fer servir el següent codi:

System.out.println(psis.common.utils.X500NameUtils.serialize(cert.getSubjectX500Principal(), Format.RFC2253, true));

Eliminar de l'string anterior tots els "\\00". Sinó no funciona bé la càrrega de la clau.

**BindingDataLoaderConfig.xml**

Actualitzar-lo per a que apunti a l'arxiu anterior.

**2.2.- Aixecar un node en mode IOP, i des de la consola, carregar la clau corresponent**.

**2.3.- Reiniciar el servei en mode normal.**

**NOTA**: En cas de problemas durant la càrrega, lo més ràpid és eliminar totes les claus ([Script per esborrar les taules de claus criptogràfiques](24215706.md)), i tornar a carregar-ho tot des de la consola java.

  

  

Document generated by Confluence on 07 junio 2025 00:00

[Atlassian](http://www.atlassian.com/)