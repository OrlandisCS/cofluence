Suport Tècnic : Monitor S.T. - EACATPL\_LIFERAY - RDBMS intern del liferay  

1.  [Suport Tècnic](index.html)
2.  [Suport Tècnic](13893782.html)
3.  [03 - Monitorització - Revisions globals](26313327.html)
4.  [Monitors S.T.](Monitors-S.T._41522177.html)
5.  [Monitor S.T. - OLD](Monitor-S.T.---OLD_118555256.html)

Suport Tècnic : Monitor S.T. - EACATPL\_LIFERAY - RDBMS intern del liferay
==========================================================================

Created by Unknown User (otecobernal), last modified by OTEC ST JAlejandro Cardete Postigo on 11 March 2022

Què mesura aquest monitor?

Aquesta sonda valida que l'actualització de peticions asincrones estigui operativa.

![](attachments/64979212/64980702.png)

Es un RDBMS especial de l'EACAT PL. Aquest RDBMS està programat al propi liferay.

**Consulta**
============

* * *

SELECT COUNT(CODI) "Registres"
  FROM lr6serveis.VO\_PETICIO
 WHERE ESTAT IN ('0001', '0002')
   AND (TER < ((SYSDATE - DATA\_ACTUALITZACIO) \* 24));

Si salta la sonda, ens haurem d'esperar un temps prudencial (RDBMS es cada 30seg amb lo que si esperem 5 minuts serà suficient) i tornar a llençar la query de dalt o la própia sonda per veure si es processen o no els registres. Si tornen a sortir, llavors s'ha de llençar la següent query per veure si dels casos que surten la data d'actualització es del mateix dia:

SELECT \* FROM lr6serveis.VO\_PETICIO 
WHERE ESTAT IN ('0001', '0002');

En cas afirmatiu, no farem res i tornarem a llençar la sonda al cap d'uns minuts, en cas negatiu llavors s'hauria de veure per la PCI en quin estat es troba i si hi ha dubtes consultar amb ST per fer l'actualització a l'estat 999 o no.

De forma adicional, podem llençar aquesta query per veure si hi ha algún registre que porta temps sense actualitzar-se:

SELECT \* FROM lr6serveis.VO\_PETICIO 
WHERE ESTAT IN ('0001', '0002') 
and DATA\_ACTUALITZACIO < Sysdate - 1;

Si ens retornés algún cas, s'hauria de veure per la PCI en quin estat es troba i si hi ha dubtes consultar amb ST per fer l'actualització a l'estat 999 o no.

**Procediment**
===============

* * *

Consultar amb ST abans d'actualitzar

En cas de detectar registres alts haurem de modificar l'estat a '999' d'aquelles peticions antigues que puguin estar bloquejant el servei.

UPDATE lr6serveis.VO\_PETICIO
SET ESTAT = '999' 
 WHERE ESTAT IN ('0001','0002') AND (TER < ((SYSDATE-DATA\_ACTUALITZACIO)\*24))

**Informació addicional**
=========================

* * *

### 1) Revisió de logs

Podrem trobar els logs a les rutes:

*   /aoc/apps/

  

  

  

Attachments:
------------

![](images/icons/bullet_blue.gif) [cds.gif](attachments/64979212/64979213.gif) (image/gif)  
![](images/icons/bullet_blue.gif) [MicrosoftTeams-image.png](attachments/64979212/64980702.png) (image/png)  

Document generated by Confluence on 02 June 2025 11:09

[Atlassian](http://www.atlassian.com/)