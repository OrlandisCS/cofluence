Suport Tècnic : Localització entrada SIR EACAT  

1.  [Suport Tècnic](index.md)
2.  [Suport Tècnic](13893782.md)
3.  [02 - FAQ's serveis](26313393.md)
4.  [FAQ's SIR 2.0](41523073.md)
5.  [SIR 2.0 - FORMACIÓ - Resolució d'incidències](93357198.md)

Suport Tècnic : Localització entrada SIR EACAT
==============================================

Created by Oriol Bernal, last modified on 20 September 2023

[ZD#132245](https://aoccat.zendesk.com/agent/tickets/132245)

**Descripció incidència**

Bon dia  
   
Usuària Virginia Mendoza Moreno 46800212L de l'Agència Tributària de Catalunya, ens indica que el febrer del 2022 els hi van enviar una tramesa SIR amb nº de registre RGE001191242022 des de l'AEAT (O00000217) que va quedar pendent de confirmar. Confirmen però que no l'han gestionat mai.  
  
Des del CAU ens impersonem i confirmem que no es troba a cap de les safates de Rebuts. Hem fet cerca tant per unitat orgànica d'origen, per nº de registre i per dates, però no l'hem localitzat.  
![](https://aoccat.zendesk.com/attachments/token/TnM1QykV2PRoa9VjGJyXXenPB/?name=image.png)  
  
   
Podríem revisar que ha pogut succeir amb aquesta tramesa?  
   
Gràcies,

Explicació

En aquest cas el problema està en el fet que l'usuari no troba un tràmit a l'aplicació del SIR. L'emissor els hi reclama perquè no l'han confirmat, però l'usuari no pot fer-ho perquè no li apareix. D'aquest fet deduïm que és una recepció, i podem replicar l'error impersonant-nos amb l'usuari: 46800212L.

El primer que necessitem fer és buscar el tràmit al backend referenciant el número de registre de l'emissor:

select case
         when i.tipus = 0 then 'Enviament'
         when i.tipus = 1 then 'Recepció'
       end as TIPUS\_INTERCANVI,
       case
         when i.estat = 0 then 'Pendent d''enviar'
         when i.estat = 1 then 'Pendent de confirmar'
         when i.estat = 2 then 'Confirmat'
         when i.estat = 3 then 'Rebutjat'
         when i.estat = 4 then 'Reenviat'
         when i.estat = 5 then 'Error'
       end as ESTAT\_LITERAL,
       case
         when a.tipus = 0 then 'Enviament'
         when a.tipus = 1 then 'Reenviament'
         when a.tipus = 2 then 'Rebuig'
         when a.tipus = 3 then 'ACK'
         when a.tipus = 4 then 'Error'
         when a.tipus = 5 then 'Confirmació'
         when a.tipus = 6 then 'Reenviament a inici'
       end as TIPUS\_APUNT,
       i.\*,
       a.\*
  from SIR\_PCI.SIR\_INTERCANVI i, SIR\_PCI.SIR\_APUNT a
 where a.id\_intercanvi = i.id
  and origen\_registre\_entrada in ('RGE001191242022')
 order by i.id, a.data asc;

Podrem veure els resultats de la consulta a la següent taula (s'han omès columnes i s'han deixat les de més interès):

Tipus Intercanvi

Estat

Tipus Apunt

ID

ID\_SIR

CODI\_ENS

ORIGEN\_REGISTRE\_ENTRADA

APLICACIO

DATA

Recepció

Pendent de confirmar

Enviament

403138

O00000217\_22\_00016286

7976100037

RGE001191242022

AEAT

04/02/22 08:00:48,856000000

Recepció

Pendent de confirmar

ACK

403138

O00000217\_22\_00016286

7976100037

RGE001191242022

AEAT

04/02/22 08:00:50,444000000

Hem trobat el tràmit, que efectivament és una recepció amb identificador O00000217\_22\_00016286, a més a més, el vam rebre el 04/02/22 i automàticamnet vam enviar l'ACK ratificant que hem rebut el tràmit correctament.

Perquè no apareix a l'EACAT? L'EACAT té la seva pròpia base de dades que ha d'estar sincronitzada amb el nostre backend, podem consultar l'estat i veure si apareix:

select \* from SIR\_EACAT.SIR\_REGISTRE\_ENTRADA
 where id\_sir = 'O00000217\_22\_00016286'

Com és una recepció, hauria d'aparèixer el registre a la taula SIR\_REGISTRE\_ENTRADA (ja que és una entrada per l'ens català). Després d'executar la query, veiem que no apareix cap resultat! És normal, perquè com hem pogut comprovar per la web tampoc ha aparegut. Haurem de forçar la sincronització del tràmit i esperar uns minuts:

update SIR\_SINCRONITZACIO set SINCRONITZAT\_EACAT = 0
where id\_intercanvi = 403138

L'id\_intercanvi fa referència a la columna ID de la taula SIR\_INTERCANVI. Passats uns minuts, veurem que el flag SINCRONITZAT\_EACAT  es torna a posar a 1

\-- Esperar fins que el flag SINCRONITZAT\_EACAT=1
select \* from SIR\_SINCRONITZACIO
where id\_intercanvi = 403138;

-- Tornar a revisar si ha aparegut el tràmit
select \* from SIR\_PCI.SIR\_INTERCANVI
where origen\_registre\_entrada in ('RGE001191242022');

Veurem que el tràmit ja apareix a les taules d'EACAT i si ens impersonem també:

![](attachments/93357272/93357281.png)

**Missatge tipus**

Bon dia,

Es va produir un error en la recepció del tràmit, avui ho hem corregit i ja us hauria d'aparèixer per l'EACAT.

Disculpeu les molèsties i salutacions

  

Attachments:
------------

![](images/icons/bullet_blue.gif) [image2023-9-15\_13-9-31.png](attachments/93357272/93357273.png) (image/png)  
![](images/icons/bullet_blue.gif) [image2023-9-15\_12-54-52.png](attachments/93357272/93357274.png) (image/png)  
![](images/icons/bullet_blue.gif) [image2023-9-15\_12-54-1.png](attachments/93357272/93357275.png) (image/png)  
![](images/icons/bullet_blue.gif) [image2023-9-15\_12-49-21.png](attachments/93357272/93357276.png) (image/png)  
![](images/icons/bullet_blue.gif) [image2023-9-15\_12-39-48.png](attachments/93357272/93357277.png) (image/png)  
![](images/icons/bullet_blue.gif) [image2023-9-15\_9-33-20.png](attachments/93357272/93357278.png) (image/png)  
![](images/icons/bullet_blue.gif) [image2023-9-15\_9-40-10.png](attachments/93357272/93357279.png) (image/png)  
![](images/icons/bullet_blue.gif) [image2023-9-15\_10-6-27.png](attachments/93357272/93357280.png) (image/png)  
![](images/icons/bullet_blue.gif) [image2023-9-19\_11-46-3.png](attachments/93357272/93357281.png) (image/png)  

Document generated by Confluence on 02 June 2025 11:00

[Atlassian](http://www.atlassian.com/)