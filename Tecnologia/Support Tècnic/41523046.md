Suport Tècnic : Monitor S.T. - CDOMICILI - Volants en estat d'error  

1.  [Suport Tècnic](index.md)
2.  [Suport Tècnic](13893782.md)
3.  [03 - Monitorització - Revisions globals](26313327.md)
4.  [Monitors S.T.](Monitors-S.T._41522177.md)
5.  [Monitors S.T. - CDOMICILI](Monitors-S.T.---CDOMICILI_128647215.md)

Suport Tècnic : Monitor S.T. - CDOMICILI - Volants en estat d'error
===================================================================

Created by Unknown User (otecobernal), last modified on 11 May 2021

Què mesura aquest monitor?

Monitora la primera fase del servei, on es demana el volant d'empadronament de la persona que canviarà de domicili (TITULAR). En fases futures, s'enviarà aquest volant a l'emissor (MINHAP, CATSALUT, etc).

El monitor mostra les peticions del padró (TITULAR) que es troben en estat d'error i han arribat a 5 reintents.

  

**Consulta**
============

* * *

SELECT COUNT(ID)
  FROM CDOMICILI.CD\_TITULAR
 WHERE ESTAT = 0 -- volant pendent
   AND INTENTS = 5;

**Procediment**
===============

* * *

### 1) Analitzar les entitats afectades

Podem extreure informació dels ens que han realitzat els consums amb la següent consulta:

SELECT ens.uen\_nom\_curt "Entitat", proces.codi\_ens "Codi", count(ens.uen\_nom\_curt) "Volants en estat d'error"
  FROM CDOMICILI.CD\_TITULAR titular, CDOMICILI.CD\_PROCES proces, usu\_ens ens
 WHERE proces.id = titular.id\_proces
   AND proces.codi\_ens = ens.uen\_codi\_ens
   AND titular.ESTAT = 0
   AND titular.INTENTS = 5
 group by ens.uen\_nom\_curt, proces.codi\_ens
 order by count(\*) desc;

  

2) Revisar les aplicacions del padró

Aquest monitor està relacionada amb l'aplicació del padró de l'Ens que realitza el canvi de domicili, ja que si el padró es troba **indisponible**, les peticions no funcionaran.

Si el servei del PADRÓ de l'Ajuntament no es troba disponible, primer haurem de solucionar el problema. Un cop es trobi disponible, podrem baixar els reintents perquè les peticions es tornin a intentar:

UPDATE CD\_TITULAR t
   set intents = 4
 where t.ESTAT = 0
   AND t.INTENTS = 5;

3) Revisar les dades informades a la petició

Si el volant del padró és un **NO\_CONSTA,** fallarà i haurem de contactar amb l'Ajuntament indicant que la persona no consta com a convivent al seu municipi.

És possible que surtin tants "errors" perquè les comunicacions es van fer de manera incorrecta (sense informar del NIF). Per comprovar aquesta casuística hem de mirar si els registres tenen el camp "DOCUMENTACIO" informat:

![](attachments/41523046/41523049.png)

En aquest cas el que s'ha de fer és pujar els reintents d'aquests registres a 10 perquè no tornin a aparèixer a la sonda.

\-- Revisar si han informat el NIF
SELECT documentacio, count(ID)
  FROM CDOMICILI.CD\_TITULAR
 WHERE ESTAT = 0
   AND INTENTS <= 5
 group by documentacio;
 
 
-- Posar 10 reintents perquè no apareguin a la sonda
update CD\_TITULAR t
   set intents = 10
 where t.ESTAT = 0
   AND t.INTENTS = 5
   and t.DOCUMENTACIO is null;

En cas que els registres pertanyin al mateix ens, podrem enviar un correu informant-los de les comunicacions incorrectes que realitzen.

Podrem  fer ús dels logs de l'aplicació després de baixar els reintents per revisar qualsevol altre tipus d'error i actuar.

Podem buscar les comunicacions a la web admin: [http://admin3.iop.aoc.cat/pci3-cdomicili-admin/](http://admin3.iop.aoc.cat/pci3-cdomicili-admin/comunicacions/11)

o buscar una comunicació específica pel seu ID: [http://admin3.iop.aoc.cat/pci3-cdomicili-admin/comunicacions/](http://admin3.iop.aoc.cat/pci3-cdomicili-admin/comunicacions/11)ID

  

  

**Informació addicional**
=========================

* * *

### 1) Revisió de logs

*   **Ruta:** /apps/aoc/IOP/logs
*   **Nom:**  MC-CDOMICILI\_IOPNODO?.log

### 2) Model de dades

#### CD\_TITULAR .ESTAT

Valor

Significat

\-1

En procés

0

Volant pendent

1

Volant obtingut

#### CD\_TITULAR.TIPUS\_DOCUMENTACIO

Valor

Significat

1

NIF

2

PASSAPORT

3

NIE

Attachments:
------------

![](images/icons/bullet_blue.gif) [cds.gif](attachments/41523046/41523047.gif) (image/gif)  
![](images/icons/bullet_blue.gif) [image2019-10-17\_9-23-38.png](attachments/41523046/41523049.png) (image/png)  

Document generated by Confluence on 02 June 2025 11:09

[Atlassian](http://www.atlassian.com/)