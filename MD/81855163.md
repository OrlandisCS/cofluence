Suport Tècnic : BOE – EACAT – Error El árbol dir3 es incorrecto - Modificació jerarquia DIR3  

1.  [Suport Tècnic](index.html)
2.  [Suport Tècnic](13893782.html)
3.  [02 - FAQ's serveis](26313393.html)
4.  [FAQ's BOE](28705545.html)

Suport Tècnic : BOE – EACAT – Error El árbol dir3 es incorrecto - Modificació jerarquia DIR3
============================================================================================

Created by Unknown User (otecjcolomer), last modified on 12 December 2022

Jerarquia DIR3

Informació de la FAQ:
---------------------

Aquesta jerarquia podrà variar periòdicament quan es produeixin canvis en l'organigrama de la Generalitat de Catalunya que modifiqui la jerarquia DIR3 de l'AOC.

  

En el cas de publicar a través de la PCI del CAOC cal informar les dades DIR3 del CAOC, i com que aquestes dades poden variar ens poden arribar tiquets amb errors com els Zendesk 47424 i el 47218. L'error que rebrem en aquests casos serà el següent:

Buscarem una petició per visualitzar l'error al MTI d'APP de PRO:  
[http://10.120.4.58/pci3-mti-admin/peticions/mti/BOEc92fc4a85798](http://10.120.4.58/pci3-mti-admin/peticions/mti/BOEc92fc4a85798)  
  
![](https://aoccat.zendesk.com/attachments/token/Wv6i5AGSffwr1SkS21X2zlrEK/?name=image.png)  
  
Revisem la petició als logs:**BOEc92fc4a85798**  
  

06 Dec 2022 00:00:13,402 ERROR BOEMngr        : cat.aoc.pci30.core.exception.PCIException: Error reportat pel BOE: El árbol dir3 es incorrecto | \[El árbol de remitentes es incorrecto en el nivel 3\]
        at cat.aoc.pci30.modalitats.boe.BOEMngr.envia(BOEMngr.java:76)
        at cat.aoc.pci30.modalitats.boe.BOEModalitats.procesa(BOEModalitats.java:56)

Un cop hàgim verificat que el problema és l'esquema de l'arbre DIR3, anirem a consultar per BBDD per extreure les dades actualitzades.

Ens situarem a l'esquema DIR3, i llançarem la següent query:

Query dades arbre DIR3

SELECT CODIGO, COD\_UNIDAD\_SUPERIOR, DENOMINACION, NIVEL\_JERARQUICO FROM DIR3\_UNIDAD\_ORGANICA  
WHERE ESTADO='V' START WITH CODIGO='A09018933' CONNECT BY NOCYCLE PRIOR COD\_UNIDAD\_SUPERIOR=CODIGO UNION  
SELECT CODIGO, COD\_UNIDAD\_SUPERIOR, DENOMINACION, NIVEL\_JERARQUICO FROM DIR3\_UNIDAD\_ORGANICA  
WHERE ESTADO='V' AND CODIGO=(SELECT COD\_UNIDAD\_SUPERIOR FROM DIR3\_UNIDAD\_ORGANICA  
WHERE CODIGO=(SELECT COD\_UNIDAD\_RAIZ FROM DIR3\_UNIDAD\_ORGANICA WHERE CODIGO='A09018933'))  
ORDER BY NIVEL\_JERARQUICO ASC

En llençar-la obtindrem una resposta tipus:

![](attachments/81855163/81855164.png)

El codi que correspon a cada Denominació i el que haurem de facilitar a l'usuari és el primer, CODIGO. L'altre, el COD\_UNIDAD\_SUPERIOR, és el codi de l'ens pare i no cal passar-lo.

![](attachments/81855163/81855165.png)

  

  

I per resoldre el tiquet podríem enviar el següent missatge tipus a l'usuari:

  

Resposta del tiquet

Benvolguts,  
   
Els adjuntem una taula amb els codis DIR3 actualitzats:  
   
![](https://aoccat.zendesk.com/attachments/token/9lWcVTChCpvZiMg0aM8XAPssV/?name=image.png)  
   
Per qualsevol altre dubte o problema que els sorgeixi els atendrem per resoldre-ho.  
Salutacions,

  

  

  

IMPORTANT DESPRÉS DE RESOLUCIÓ DEL TIQUET

Un cop hàgim respòs a l'usuari tocarà documentar aquestes modificacions que s'han produït a l'esquema del DIR3, tant des de Suport Tècnic com el github.

Obriríem primer tiquet a Suport Tècnic demanant el Word amb el Document d'integració del servei BOE - TEU per corroborar les dades que hem trobat a la BBDD, i amb aquestes dades (si veiem que coincideixen) aniríem al github a actualitzar la info: [https://github.com/ConsorciAOC/BOE](https://github.com/ConsorciAOC/BOE)

Aquí, si busquem en el document la paraula "nivel" anirem a parar a l'apartat que hem de modificar:

![](https://contacte.aoc.cat/secure/attachment/88938/88938_image-2022-12-07-13-55-10-228.png)

  

Les noves dades s'han de canviar tant a l'apartat **/envio/anuncios/nodoRemitente@nivell**  com a **//anuncio/emisor/nodoEmisor@nivell (els dos requadres marcats en vermell).**

Ens podríem trobar amb el següent cas. Haurem de modificar aquestes dades desactualitzades:

  

<remitente>
 <nodoRemitente nivel="1" idDir3="A99999999"\>ComunidadesAutonomas</nodoRemitente> 
 <nodoRemitente nivel="2" idDir3="A09002970"\>Generalitatde Catalunya</nodoRemitente> 
 <nodoRemitente nivel="3" idDir3="A09018799"\>Departamento de Políticas Digitales yAdministraciones Públicas</nodoRemitente> 
 <nodoRemitente nivel="4" idDir3="A09018933"\>ConsorciAdministració Oberta de Catalunya</nodoRemitente>
</remitente>

  

Per aquestes altres noves i actualitzades: 

  

<remitente>
 <nodoRemitente nivel="0" idDir3="A99999999"\>ComunidadesAutonomas</nodoRemitente> 
 <nodoRemitente nivel="1" idDir3="A09002970"\>Generalitatde Catalunya</nodoRemitente> 
 <nodoRemitente nivel="2" idDir3="A09002971"\>Departament de la Presidència</nodoRemitente> 
 <nodoRemitente nivel="3" idDir3="A09041912"\>Secretaría de Telecomunicaciones y Transformación Digital</nodoRemitente> 
 <nodoRemitente nivel="4" idDir3="A09018933"\>Consorci Administració Oberta de Catalunya</nodoRemitente>
</remitente>

  

Com podem veure, a vegades canvien pocs detalls, el número del nivell, o el nom. 

  

**Si no coincideixen les dades que veiem al document Word amb les que treiem de la query llançada a la BBDD podem preguntar a Suport Tècnic o a David Tejada directament.**

Related articles
----------------

  

Related issues

ZD#47424

ZD#47218

Attachments:
------------

![](images/icons/bullet_blue.gif) [image2022-12-12\_17-4-24.png](attachments/81855163/81855164.png) (image/png)  
![](images/icons/bullet_blue.gif) [image2022-12-12\_17-8-18.png](attachments/81855163/81855165.png) (image/png)  

Document generated by Confluence on 02 June 2025 10:51

[Atlassian](http://www.atlassian.com/)