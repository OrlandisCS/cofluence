Suport Tècnic : Monitor S.T. - REPRESENTA - Signatures representa que no s'han generat  

1.  [Suport Tècnic](index.md)
2.  [Suport Tècnic](13893782.md)
3.  [03 - Monitorització - Revisions globals](26313327.md)
4.  [Monitors S.T.](Monitors-S.T._41522177.md)
5.  [Monitors S.T. - REPRESENTA](Monitors-S.T.---REPRESENTA_128647237.md)

Suport Tècnic : Monitor S.T. - REPRESENTA - Signatures representa que no s'han generat
======================================================================================

Created by Unknown User (otecobernal), last modified by Joan Riquelme on 16 April 2025

Què mesura aquest monitor?

Quan es rep una petició de **REPRESENTA**, es necessita realitzar una signatura per donar una validesa assegurant que s'ha realitzat una representació.

Es genera la signatura amb un certificat del consorci. Aquesta operació es realitza pel mòdul del **MSC** de la **PCI**, que a la vegada es recolza sobre el servei del **SSC** (TrustedX).

L'operació de signar es fa de manera asíncrona respecte a la petició inicial.

El següent monitor conta el nombre de signatures que no s'han pogut realitzar després de 3 reintents.

  

**Consulta**
============

* * *

SELECT count(UUID) REGISTRES
  FROM REPRESENTA.R\_SIGNATURA\_EVIDENCIA
 WHERE SIGNAT = 0
   AND IN\_PROGRESS = 0
   AND REINTENTS >= 3;

**Procediment**
===============

* * *

Actuarem quan hi hagi 10 o més signatures en estat d'error.

Per tal de revisar les alertes haurem de realitzar les següents passes:

### 1) Revisar l'estat del MSC

Si detectem que l'MSC no està tractant correctament les peticions, haurem de traspassar-ho a Suport Tècnic, ja que s'haurà d'actuar a la resolució amb la plataforma de la PCI i es tractarà d'un problema generalitzat que afectarà molts més serveis.

### 2) Reiniciar les peticions de signatura

Si el MSC no falla, provarem de reiniciar les peticions, ja que podrien ser errors puntuals.

SELECT \*
  FROM REPRESENTA.R\_SIGNATURA\_EVIDENCIA
 WHERE SIGNAT = 0
   AND IN\_PROGRESS = 0
   AND REINTENTS >= 3;

UPDATE R\_SIGNATURA\_EVIDENCIA
   set reintents = 2
 where UUID IN (SELECT uuid
                  FROM REPRESENTA.R\_SIGNATURA\_EVIDENCIA
                 WHERE SIGNAT = 0
                   AND IN\_PROGRESS = 0
                   AND REINTENTS >= 3);

Un cop reiniciades, ens haurem d'assegurar que l'RDBMS **REPRESENTA-SIGNATURA** les processa correctament.

### 3) Comentar-ho internament amb el responsable del projecte

Si després d'aplicar el procediment, les signatures segueixen arribant a 3 reintents, podrem obrir un Jira a Desenvolupament (Jordi Florit) o mencionar-lo si ja tenim un tiquet obert, per tal de revisar sobre com procedir en aquests casos.

**Informació addicional**
=========================

* * *

### 1) Revisió de logs

Podrem trobar els logs a les rutes:

*   /aoc/apps/APP/logs/Representa\_APPNODO1\_SOA**.**log
*   /aoc/apps/APP/logs/Representa-portal\_tomcat8-01.log

### 2) Servidors

Servidors 
==========

*   Node1: **aoc-l-soa01 → 10.120.1.163 [](https://pam.aoc.cat/SecretServer/app/#/secrets/4785/general)** 
    
*   Node2: **aoc-l-soa02 → 10.120.1.164 [](https://pam.aoc.cat/SecretServer/app/#/secrets/4786/general)** 
*   Node3: **aoc-l-soa03 → 10.120.1.172 [](https://pam.aoc.cat/SecretServer/app/#/secrets/4787/general)** 
*   User: **soa**  
    

 Admin: **[http://10.120.1.163:7001/console/login/LoginForm.jsp](http://10.120.1.163:7001/console/login/LoginForm.jsp)[](https://pam.aoc.cat/SecretServer/app/#/secrets/4777/general)**

*   Node1: **aoc-l-soa01-pre → 10.120.2.125 [](https://pam.aoc.cat/SecretServer/app/#/secrets/4745/general)** 
    
*   Node2: **aoc-l-soa02-pre → 10.120.2.126 [](https://pam.aoc.cat/SecretServer/app/#/secrets/4744/general)** 
*   Node3: **aoc-l-soa03-pre → 10.120.2.136 [](https://pam.aoc.cat/SecretServer/app/#/secrets/4746/general)** 
*   User: **soa**

 Admin: **[http://10.120.2.125:7001/console/login/LoginForm.jsp](http://10.120.2.125:7001/console/login/LoginForm.jsp) [](https://pam.aoc.cat/SecretServer/app/#/secrets/4734/general)** 

  

  

### 3) Model de dades

#### R\_SIGNATURA\_EVIDENCIA.SIGNAT

Valor

Significat

0

No signat

1

Signat

#### R\_SIGNATURA\_EVIDENCIA.IN\_PROGRESS

Valor

Significat

0

Finalitzat

1

En progrés

Attachments:
------------

![](images/icons/bullet_blue.gif) [cds.gif](attachments/41522995/41522996.gif) (image/gif)  

Document generated by Confluence on 02 June 2025 11:09

[Atlassian](http://www.atlassian.com/)