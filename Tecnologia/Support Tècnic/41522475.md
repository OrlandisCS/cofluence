Suport Tècnic : EACAT - PL6 - Reindexació continguts Liferay6  

1.  [Suport Tècnic](index.md)
2.  [Suport Tècnic](13893782.md)
3.  [04 - Tècnica de sistemes + 24x7 + Padró](26313202.md)
4.  [Plataformes](Plataformes_41520520.md)
5.  [EACAT - PL6](EACAT---PL6_41520630.md)

Suport Tècnic : EACAT - PL6 - Reindexació continguts Liferay6
=============================================================

Created by Unknown User (otecjriquelme), last modified by Oriol Bernal on 02 December 2024

Realitzar aquesta acció a la tarda perquè no afecti el servei al matí, què sol ser l'hora punta de l'utilizació d'EACAT. A partir de les 16h.

No s'actualitzen correctament les cartes de serveis en el gestor de continguts de Liferay6.

Guia detallada
--------------

S'hauran de realitzar les següents accions:

A tenir en compte

Cal avisar a sistemes per l'aturada del node (grup de Sistemes i Suport tècnic en Teams).

Que no estiguin en període de desplegament (Dimecres de 15:00 a 17:00)

Es pot accedir al primer node a través de [https://pam.aoc.cat/SecretServer/login.aspx](https://pam.aoc.cat/SecretServer/login.aspx "https://pam.aoc.cat/secretserver/login.aspx"). A dins la secció "Plataforma EACAT PL Liferay 6.2 → PRO → l → liferay 6- pro1(o pro2) -tomcat6. Des d'aquí podrem accedir amb Putty i començar amb els següents passos.

1.  Aturar el node de liferay6.
    
    **Aturar el Tomcat**
    
    sudo /etc/init.d/tomcat7 stop
    
2.  Eliminar el contingut de la carpeta /apps/liferay/data/lucene
    
    rm -R /apps/liferay/data/lucene
    
3.  Modificar la property index.on.startup al valor **true** del fitxer /apps/tomcat/webapps/ROOT/WEB-INF/classes/portal-ext.properties
    
    **Aquesta property es va canviar a false amb el expert del liferay:  [ST-24078](https://contacte.aoc.cat/browse/ST-24078?src=confmacro) - Data cannot be retrieved due to an unexpected error.  → de moment no fem el canvi**  
      
    
    vi /apps/tomcat/webapps/ROOT/WEB-INF/classes/portal-ext.properties
    
    (prémer la tecla " i " per modificar i un cop acabada la modificació prémer la tecla ESC i escriure " :wq! " per guardar el contingut.
    
4.  Aixecar el node liferay6
    
    **Aixecar el Tomcat**
    
    sudo /etc/init.d/tomcat7 start && tail -f /apps/tomcat/logs/catalina.out
    
    Hem d'esperar que el node acabi d'aixecar-se.
    
5.  Un cop aixecat i reindexat tot, deixar la property a false pels següents reinicis que es facin.
    
    vi /apps/tomcat/webapps/ROOT/WEB-INF/classes/portal-ext.properties
    
6.  Realitzar els passos 1 → 5 en l'altre node. Si es veu convenient, es pot començar la reindexació del segon node abans que finalitzi el primer.

  

Aquest procés pot trigar molt de temps a què acabi la reindexació de tot el contingut. La manera de comprovar que està tot reindexat és mirar els fitxers de la carpeta /apps/liferay/data/lucene i veure la data d'actualització.

Document generated by Confluence on 02 June 2025 11:15

[Atlassian](http://www.atlassian.com/)