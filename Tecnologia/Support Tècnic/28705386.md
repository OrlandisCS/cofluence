Suport Tècnic : Monitor S.T. - e-NOTUM - Errors dipòsit últimes 2 hores  

1.  [Suport Tècnic](index.md)
2.  [Suport Tècnic](13893782.md)
3.  [03 - Monitorització - Revisions globals](26313327.md)
4.  [Monitors S.T.](Monitors-S.T._41522177.md)
5.  [Monitor S.T. - OLD](Monitor-S.T.---OLD_118555256.md)

Suport Tècnic : Monitor S.T. - e-NOTUM - Errors dipòsit últimes 2 hores
=======================================================================

Created by Unknown User (otecobernal), last modified by OTEC ST Alessandro Trombin Martinez on 02 March 2022

**Query:**

SELECT count(ID) REGISTRES
FROM NT30.aoc\_nt\_event\_motor
where (data\_accio is null OR data\_accio between SYSDATE - INTERVAL '120'
MINUTE and sysdate)
AND estat = 2
and fase = 'FASE\_DIPOSIT'

**Descripció:** 

Aquesta sonda consulta els estats de la "_event motor_" on la data d'acció sigui null (si es null mai s'executarà la fase), i un rang de temps inferior a dues hores des del moment que s'executa la query. A més, que l'estat sigui d'error en la FASE\_DIPOSIT. Quan una notificació ha sigut signada i registrada posteriorment es dipositarà, si fallen moltes notificacions en aquesta fase, és perquè no s'estan dipositant i segurament sigui un error en l'àmbit d'eNOTUM.

**Actuació:** 

Obtenim les notificacions afectades per l'error, i l'entitat que les ha creat:

SELECT mm.\*, entitat.id\_ens, entitat.nom
FROM NT30.aoc\_nt\_event\_motor mm, nt30.aoc\_nt\_notificacions notificacio, nt30.aoc\_nt\_tramesa tramesa, nt30.aoc\_nt\_entitat entitat
WHERE entitat.id\_entitat = tramesa.id\_entitat
AND tramesa.id\_tramesa = notificacio.id\_tramesa
and mm.id\_notificacio = notificacio.id\_notificacio
and (mm.data\_accio is null OR mm.data\_accio between SYSDATE - INTERVAL '120' MINUTE and sysdate)  
AND mm.estat = 2 and mm.fase = 'FASE\_DIPOSIT';

Agafem els ID\_Notificació afectats i cerquem logs:

select \* from nt30.aoc\_nt\_logs
where id\_notificacio in (XXXXXX))

Hauríem de veure:

	Error a la fase de diposit
	ERROR DURANT L'EXECUCIO DE LA FASE. Causa : cat.aoc.enotum.motor.MotorException: Error dipositant la notificacio \[XXXXXX\]

  

Comprovem si l'entitat ha realitzat més notificacions i s'han dipositat:

SELECT notificacio.estat, count (\*)
  FROM nt30.aoc\_nt\_notificacions notificacio,
       nt30.aoc\_nt\_tramesa       tramesa,
       nt30.aoc\_nt\_entitat       entitat
 WHERE entitat.id\_entitat = tramesa.id\_entitat
   AND tramesa.id\_tramesa = notificacio.id\_tramesa
AND entitat.id\_ens = 'XXXXXXXXX'
group by notificacio.estat

  

En cas que l'entitat hagi realitzat més notificacions correctament, hauríem de veure quan han començat a fallar.

Aquest error se sol produir perquè no tenen cap certificat carregat o aquest està caducat. Comprovarem si el certificat que l'entitat utilitza per eNOTUM està caducat està caducat.

Podem veure com comprovar-ho en la següent FAQ: [SSC (TrustedX) - FLUX DEL SERVEI - Revisió de certificats](26313660.md)

**logs:** 

*   **Servidor: SOA - PCI3**
*   **Ruta: /mnt/storage30/aoc/NT/logs**
*   **Nom:  NT-NTNODO1\_SOA.log**

Document generated by Confluence on 02 June 2025 11:09

[Atlassian](http://www.atlassian.com/)