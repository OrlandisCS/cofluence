Suport Tècnic : OVER - FLUX DEL SERVEI - ADJUNTS - Extreure l'XML del PDF i tractar-ho  

1.  [Suport Tècnic](index.html)
2.  [Suport Tècnic](13893782.html)
3.  [02 - FAQ's serveis](26313393.html)
4.  [FAQ's OVER](28705589.html)
5.  [OLD\_OVER](OLD_OVER_41522665.html)

Suport Tècnic : OVER - FLUX DEL SERVEI - ADJUNTS - Extreure l'XML del PDF i tractar-ho
======================================================================================

Created by Unknown User (cmoralea), last modified by Unknown User (oteccmorales) on 30 October 2019

Per extreure les dades del PDF en XML i així poder omplir-les.

Accions:
--------

1.  L'OT d'EACAT ens ha indicat 2 formes d’extreure l'XML del PDF, **una amb llibreries iText** i l’altre **amb mètodes del LiveCycle** :  
      
    

**iText (Versió 5.5.13)**

Exemple amb codi C#.

  

xmlDocument xmlDocument **\=** **new** XmlDocument**();** 

  

PdfReader pdfReader **\=** **new** PdfReader**(**fileName**);**

XfaForm xfaForm **\=** **new** XfaForm**(**pdfReader**);**

**this****.**xmlData **\=** xfaForm**.**DatasetsNode**.**FirstChild**;** 

xmlDocument**.**LoadXml**(****this****.**xmlData**.**OuterXml**);**

  

**LiveCycle**

Aquesta és en codi JAVA i fa l’extracció realitzant la crida a serveis del LiveCycle.

T’envio també l'XML (FormDataIntegration.xml) del resultat del WSDL dels mètodes del nostre LiveCycle.

  

[https://ElNostreLiveCycle/soap/services/FormDataIntegration?wsdl](https://elnostrelivecycle/soap/services/FormDataIntegration?wsdl)

  

  

  

    public byte**\[\]** export **(**byte**\[\]** interactivePdf**)** **throws** Throwable **{**

        FormDataIntegration lc **\=** **new**FormDataIntegrationService**().**getFormDataIntegration**();** 

        **((**BindingProvider**)**lc**).**getRequestContext**().**put**(**

                BindingProvider**.**ENDPOINT\_ADDRESS\_PROPERTY**,**

                ConfiguradorFactory**.**getInstance**().**getProperty**(**"lc.endpoint"**)** **+** "/soap/services/FormDataIntegration"

        **);**

        initRequestContext**(((**BindingProvider**)**lc**).**getRequestContext**());** 

        BLOB inPdfDoc **\=** **new** BLOB**();**

        inPdfDoc**.**setBinaryData**(**interactivePdf**);**

        inPdfDoc**.**setContentType**(**"application/pdf"**);**

        String url **\=** lc**.**exportData**(**inPdfDoc**).**getRemoteURL**();**

        **return** download**(****new** URL**(**url**));**

    **}**

  

Per tractar el PDF:

Codi per tractar el PDF:

  

pdfReader per fer lectura.

pdfStamper per modificar el PDF.

![](http://atenciousuaris.aoc.cat/MRcgi/MRdownloadAttachment.pl?USER=OTSupTec3&PROJECTID=15&MRP=187c9da2f29fb12ba6d8db6e76281dddb&MR=216650&CUSTM=&WYSIWYG_IMAGE=1&ORIGINAL_PROJECT=&ATTACHMENT_NAME=image_1548071250__dpng)

  

Related articles
----------------

  

Related issues

FP#254492

Document generated by Confluence on 02 June 2025 10:57

[Atlassian](http://www.atlassian.com/)