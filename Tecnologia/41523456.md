Suport Tècnic : SIR 2.0 - Integració  

1.  [Suport Tècnic](index.html)
2.  [Suport Tècnic](13893782.html)
3.  [02 - FAQ's serveis](26313393.html)
4.  [FAQ's SIR 2.0](41523073.html)

Suport Tècnic : SIR 2.0 - Integració
====================================

Created by David Tejada, last modified by Cristian Morales on 13 March 2023

Pasos a seguir per la integració

  

DI:

[![](rest/documentConversion/latest/conversion/thumbnail/41523849/1)](/download/attachments/41523456/DI%20-%20SIR.doc?version=1&modificationDate=1626348494865&api=v2)

Ens proves

En PRE tenim els ens:

Sabadell → agafat per Sabadell - O00007955

Reus → agafat per BASE - O00007762

BCN → Agafat per BCN

O00015791 -> Registro del Departamento de Agricultura, Ganadería, Pesca, Alimentación y Medio → S@RCAT

Òrgans destí:

Catarroja → O00002721 

Jun ->

  

  

*   Donar d'alta a PRE
    *   Activar en el DIR3 de PRE les oficines de registre que poden interactuar amb el SIR. Important, en el DIR3, cal que estigui bé la Unitat orgànica amb el ine10 informat al camp COD\_EXTERNO. 

\-- Query per buscar
SELECT ofi.codigo       "Codigo oficina",
       ofi.denominacion "Denominacion oficina",
       uo.codigo        "Codigo unidad",
       uo.cod\_externo   "INE10",
       uo.denominacion  "Denominacion unidad"
  FROM DIR3.DIR3\_OFICINA\_REGISTRO ofi
  LEFT JOIN DIR3.DIR3\_UNIDAD\_ORGANICA uo
    ON ofi.COD\_UO\_RESPONSABLE = uo.CODIGO
WHERE uo.cod\_externo = '8004333033';

-----------------------------------------
Esquema DIR3 de PRE (Ora12)

select codigo, denominacion from dir3\_oficina\_registro where codigo in (select dir3 from dir3\_2\_ine10\_of where ine10='4312330008');

select codigo, denominacion from dir3\_unidad\_organica where codigo in (select dir3 from dir3\_2\_ine10\_uo where ine10='4312330008');

Validar en DIR3

Validar que en aquestes consultes està:

  

select \* from DIR3.DIR3\_RELACION\_SIR a
where a.COD\_OFICINA = 'O00007762';

Surt l'Oficina en Estat "V"

![](attachments/41523456/81855716.png)

select \* from DIR3.DIR3\_SERVICIO\_OFICINA\_REGISTRO a
where a.CODIGO\_OFICINA = 'O00007762';

El codi 5, 6 i 7 estàn informats.

![](attachments/41523456/81855715.png)

Si no surten les dades

Si en el DIR3 no tenim les dades, comentem amb David sin llançem la sincro del DIR3 en PRE

URL per llençar sincro del DIR3 de PRE

Una vegada clickem a la URL es fa la sincro,

[http://10.120.2.28:8082/dir3-moduleOra12/DIR3Import](http://10.120.2.28:8082/dir3-moduleOra12/DIR3Import)

  

  

*   Amb la segona consulta, trèiem la denominació de l'OR i OF:

![](attachments/41523456/41523697.png)

![](attachments/41523456/41523698.png)

*   Amb aquesta informació obrim tiquet al MINHAP -SIR: [https://ssweb.seap.minhap.es/ayuda/consulta/sir](https://ssweb.seap.minhap.es/ayuda/consulta/sir)

![](attachments/41523456/41523701.png)

![](attachments/41523456/41523699.png)

*   Missatge tipus:

Buenos días, necesitamos que se activen para poder enviar y recibir en la aplicación SIR del entorno de PRE las siguientes oficinas de registro:

  

O00007955 (Registro General del Ayuntamiento de Sabadell) - L01081878 (Ayuntamiento de Sabadell)

O00007762 (Registro General del Ayuntamiento de Reus) - L01431233 (Ayuntamiento de Reus)

FP#433619

Saludos.

de cara MINHAP només està integrat AOC

MOLT IMPORTANT: MAI DE LA VIDA SE LI POT DIR AL MINISTERI RES SOBRE INTEGRACIONS, "oficialment" mai es faran

Si ens demanen la causa de per què demanem noves oficines indiquem:

Estamos realizando pruebas para hacer correctivos en nuestra plataforma, y que necesitamos simular la estructura de oficinas de PRO

[ST-16393](https://contacte.aoc.cat/browse/ST-16393?src=confmacro) - Data cannot be retrieved due to an unexpected error.  

Quan rebem l'OK validar per EACAT de PRE:

![](attachments/41523456/41523704.png)

En l'imatge anterior es veu que no surt l'Oficina i en la de sota es confirma que està ok (quan ha donat ok el MINHAP)

![](attachments/41523456/41523713.png)

*   Activar en la caixa negra del CIR
*   Taula 

\--- select \* from SIR\_CIR\_P2P.URL\_APLICACIONES a; a ORA12 de PRE

  

INSERT INTO url\_aplicaciones (cd\_oficina\_registro, ds\_oficina\_registro, url) VALUES ('OFICINA\_registro' , 'NOM\_OFICINA', 'http://admin3-pre.app.aoc.cat/CAOC-PCI30-MC-SIR/WS\_SIR8\_BService?method=envioFicherosAAplicacion');

INSERT INTO url\_aplicaciones (cd\_oficina\_registro, ds\_oficina\_registro, url) VALUES ('OFICINA\_mensaje' , 'NOM\_OFICINA', 'http://admin3-pre.app.aoc.cat/CAOC-PCI30-MC-SIR/WS\_SIR9Service?method=envioMensajeDatosControlAAplicacion');

  

\--- select \* from SIR\_CIR\_P2P.CONFIGURACION a;

INSERT INTO CONFIGURACION (PARAMETRO, VALOR) VALUES ('OFICINA\_SICRES', '3.0');
INSERT INTO CONFIGURACION (PARAMETRO, VALOR) VALUES ('OFICINA\_Integracion', 'WS');
INSERT INTO CONFIGURACION (PARAMETRO, VALOR) VALUES ('OFICINA\_Attachments', 'N');

Exemple:

INSERT INTO url\_aplicaciones (cd\_oficina\_registro, ds\_oficina\_registro, url) VALUES ('O00007955\_registro' , 'Registro General del Ayuntamiento de Sabadell', 'http://admin3-pre.app.aoc.cat/CAOC-PCI30-MC-SIR/WS\_SIR8\_BService?method=envioFicherosAAplicacion');
 
INSERT INTO url\_aplicaciones (cd\_oficina\_registro, ds\_oficina\_registro, url) VALUES ('O00007955\_mensaje' , 'Registro General del Ayuntamiento de Sabadell', 'http://admin3-pre.app.aoc.cat/CAOC-PCI30-MC-SIR/WS\_SIR9Service?method=envioMensajeDatosControlAAplicacion');


INSERT INTO CONFIGURACION (PARAMETRO, VALOR) VALUES ('O00007955\_SICRES', '3.0');
INSERT INTO CONFIGURACION (PARAMETRO, VALOR) VALUES ('O00007955\_Integracion', 'WS');
INSERT INTO CONFIGURACION (PARAMETRO, VALOR) VALUES ('O00007955\_Attachments', 'N');


INSERT INTO url\_aplicaciones (cd\_oficina\_registro, ds\_oficina\_registro, url) VALUES ('O00007762\_registro' , 'Ayuntamiento de Reus', 'http://admin3-pre.app.aoc.cat/CAOC-PCI30-MC-SIR/WS\_SIR8\_BService?method=envioFicherosAAplicacion');
 
INSERT INTO url\_aplicaciones (cd\_oficina\_registro, ds\_oficina\_registro, url) VALUES ('O00007762\_mensaje' , 'Ayuntamiento de Reus', 'http://admin3-pre.app.aoc.cat/CAOC-PCI30-MC-SIR/WS\_SIR9Service?method=envioMensajeDatosControlAAplicacion');


INSERT INTO CONFIGURACION (PARAMETRO, VALOR) VALUES ('O00007762\_SICRES', '3.0');
INSERT INTO CONFIGURACION (PARAMETRO, VALOR) VALUES ('O00007762\_Integracion', 'WS');
INSERT INTO CONFIGURACION (PARAMETRO, VALOR) VALUES ('O00007762\_Attachments', 'N');

.rwui\_text\_box.rwui\_id\_1f861750-4a0f-4f9c-9778-f54bbfc64742 {background-color: #F2F2F2; color: #666666;}.rwui\_text\_box.rwui\_id\_1f861750-4a0f-4f9c-9778-f54bbfc64742 \*:not(.rwui\_content) {color: #666666;}.rwui\_text\_box.rwui\_id\_1f861750-4a0f-4f9c-9778-f54bbfc64742 span.rwui\_icon {color: #666666;}

*   Afegir a la taula interna del SIR que aquesta entitat ho fa via integració.

\---select \* from SIR\_PCI.SIR\_EXTERN a;

insert into sir\_extern values ('INE10');

.rwui\_text\_box.rwui\_id\_ada52f70-1a67-43e1-a4ec-90bf8faf5cce {background-color: #F2F2F2; color: #666666;}.rwui\_text\_box.rwui\_id\_ada52f70-1a67-43e1-a4ec-90bf8faf5cce \*:not(.rwui\_content) {color: #666666;}.rwui\_text\_box.rwui\_id\_ada52f70-1a67-43e1-a4ec-90bf8faf5cce span.rwui\_icon {color: #666666;}

*   Afegir en el SIRI l'autorització.

  

Aspectes a tenir en compte de cara a la integració.

Fer proves. URL del ORVE de PRE: [https://ssweb.seap.minhap.es/demoorve/](https://ssweb.seap.minhap.es/demoorve/) User: 41096324q la contra es la mateixa que l'usuari. Si dona problemes, obrir tiquet [https://ssweb.seap.minhap.es/ayuda/consulta/orve](https://ssweb.seap.minhap.es/ayuda/consulta/orve) - A09018933

![](attachments/41523456/81855577.png)

*   Implementar una sincronització recurrent per saber els canvis que ha rebut en les intercanvis (canvis d'estat, nous intercanvis)
    
    La sincronització
    
    El procés de sincronització dels canvis d'estat, només mostra els canvis d'estat realitzats per agents externs i no es pot filtrar per dates. És a dir la sincronització retorna els últims canvis d'estats rebuts generats des de l'última sincronització realitzada.
    
    Si el propi ens fa un canvi d'estat (per exemple una conformació) aquest no es visualitzarà, ja que és un canvi que ha realitzat ell mateix...
    
    FP#441716
    
    Error en la sincro -> [SIR 2.0 - FLUX DEL SERVEI - ERRORS - Error en l'ok de la resposta d'una sincronització](41524010.html)
    
*   Un cop estigui en mode integració, a través del portlet no es rebrà cap intercanvi.

  

Un cop estigui correcte el funcionament, per fer l'activació a PRO només caldrà

*   Afegir en el SIRI l'autorització
*   Afegir a la taula interna del SIR per indicar que és extern.

  

Attachments:
------------

![](images/icons/bullet_blue.gif) [image2021-6-22\_13-41-35.png](attachments/41523456/41523697.png) (image/png)  
![](images/icons/bullet_blue.gif) [image2021-6-22\_13-41-57.png](attachments/41523456/41523698.png) (image/png)  
![](images/icons/bullet_blue.gif) [image2021-6-22\_13-43-15.png](attachments/41523456/41523699.png) (image/png)  
![](images/icons/bullet_blue.gif) [image2021-6-22\_13-45-3.png](attachments/41523456/41523701.png) (image/png)  
![](images/icons/bullet_blue.gif) [image2021-6-22\_14-17-23.png](attachments/41523456/41523704.png) (image/png)  
![](images/icons/bullet_blue.gif) [image2021-6-22\_16-52-39.png](attachments/41523456/41523713.png) (image/png)  
![](images/icons/bullet_blue.gif) [DI - SIR.doc](attachments/41523456/41523849.doc) (application/msword)  
![](images/icons/bullet_blue.gif) [image2023-2-8\_15-56-26.png](attachments/41523456/81855577.png) (image/png)  
![](images/icons/bullet_blue.gif) [image2023-3-13\_13-6-31.png](attachments/41523456/81855715.png) (image/png)  
![](images/icons/bullet_blue.gif) [image2023-3-13\_13-7-21.png](attachments/41523456/81855716.png) (image/png)  

Document generated by Confluence on 02 June 2025 11:00

[Atlassian](http://www.atlassian.com/)